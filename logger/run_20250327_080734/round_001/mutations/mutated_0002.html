<!DOCTYPE html>

<head data-uncovered-attr="fuzz" onblur="triggerFuzz()"><title data-uncovered-attr="fuzz" onerror="triggerFuzz()">ASan Stress Test</title><title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><style data-uncovered-attr="fuzz" onabort="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><meta content="default-src 'self' 'unsafe-inline'" data-uncovered-attr="fuzz" http-equiv="Content-Security-Policy" onabort="triggerFuzz()" onblur="triggerFuzz()"/><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('Mutation: ');</script><meta content="1" data-uncovered-attr="fuzz" name="mutation-round" onblur="triggerFuzz()"/><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('Mutation: ');</script><meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/><meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/><meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/><meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/><meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/><meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/><script>function triggerFuzz() {}</script><script async="">
        window.__jsCoverage = new Proxy({}, {
            get(t, p) { return t[p] || 0 },
            set(t, p, v) { t[p] = (t[p] || 0) + 1; return true }
        });
        </script></head><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><html data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page</h1>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" width="400"></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()"></pre>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
</html><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page</h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="trifgerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" width="400"></canvas>
<h2 data-uncovered-attr="fuzz" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onerror="triggerFuzz()"></pre>
<script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><head data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><h2 data-det-step="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()">Log</h2><h2 data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()">Canvas Stress Area</h2><html data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><title data-uncovered-attr="fuzz" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title><style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><meta content="1" data-uncovered-attr="fuzz" name="mutation-round" onabort="triggerFuzz()" onblur="triggerFuzz()"/></head><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><html data-uncovered-attr="fuzz" dir="ltr" lang="xx-YY" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http:/example.com/blocked.css" onabort="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head>
<body data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-entangled="cebae320-2de5-442d-a2f3-76b44727c649" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onblur="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="728f7d07-e74c-46ed-9d69-001dfb2e1f53" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-entangled="278c0bb5-0b6d-4a8b-9b13-1da4f2ebc38a" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="728f7d07-e74c-46ed-9d69-001dfb2e1f53" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2><h2 data-entangled="fd0f3ad2-39c3-4877-98df-253a2103868d" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<label data-uncovered-attr="fuzz" for="unlinkedInput" mouseover="alert('Interactive mutation at step 0');" onabort="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label> <span data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">&lt;!-- Appears broken in IE --&gt;<script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <entanglement-wrapper><input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/></entanglement-wrapper> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFu�z()" onerror="triggerfuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/><input data-entangled="ceb5791d-3845-4473-8b08-0c00629ea472" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><label data-entangled="5636987b-05e1-41ae-960f-978c146ec6fb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div><div data-entangled="b73cb476-6cac-4d61-9c22-0a21899d0fdf" data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="trigcerFuzz()" onerror="triggerFuzz()" type="swbmit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="in0ut" onblur="triggerFuzz()" onerror="triggerFuzz()" type="invalid"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="i~put" onerror="triggerFuzz()" type="invalid"/><input name="inpu|" type="number"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()"><br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-entangled="53e93531-2b2e-4293-a842-b03836983ce7" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill click="function handleEvent() {
    try {
        try {
        const res = window.mutationCounter++;
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="4fa9fd8e-47ad-46e7-b518-dfd2ff3012f9" data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onblur="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
&lt;!-- Temporary fix --&gt;<entanglement-wrapper><br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper><br data-entangled="e17fbd0d-2bdd-4719-b5b7-a600baf96012" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<entanglement-wrapper data-uncovered-attr="fuzz" onerror="triggerFuzz()"><label data-uncovered-attr="fuzz" for="unlinkedInput" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label></entanglement-wrapper> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" role="butt/n" tabindex="">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<entanglement-wrapper><a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="6" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a></entanglement-wrapper><a data-entangled="4b42c2a6-d7eb-4a6e-b29f-ea2448efc1a3" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        document.querySelectorAll('*')
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="trigg�rFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><input data-entangled="76d4fe7a-8f44-4d3a-81c4-354373562723" data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onabort="triggerFuzz()" onblur="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill><input data-uncovered-attr="fuzz" name="hnput" onabort="triggerFuzz()" type="invalid"/><input data-entangled="c6324e21-a80d-49dd-91d5-73af7d011f04" data-uncovered-attr="fuzz" name="hnput" onabort="triggerFuzz()" type="invalid"/><input name="iNput" type="number"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div><div data-entangled="b4590d32-e4d2-459d-bc25-5b5e35bae516" data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/><br data-entangled="cd37227c-a880-442a-80f5-7b980ea881d4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<entanglement-wrapper data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script></entanglement-wrapper><script data-entangled="d742e073-6b83-49a6-a11d-475b051de886" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz )" onblur="tsiggerFuzz()" onerror="triggerFuzz()" style="margin-dop: 3em;">End of Combined Page Content</p>
</body><mutation-marker data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Active &lt;iframe&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFUzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><head data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" load="alert('Interactive mutation at step 1');" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
&lt;!-- Appears broken in IE --&gt;<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
&lt;!-- Appears broken in IE --&gt;<link data-uncovered-attr="fuzz" href="http://example.com/blocked.css" onabort="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="inp}t" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu|" onblur="triggerFuzz()" onerror="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-entangled="324a7be8-14cf-47a9-9274-3d36d28dcf6d" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="ilput" onerror="triggerFuzz()" type="number"/><input name="inpqt" type="text"/></form><mutation-marker data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><mutation-marker data-entangled="9a39a90e-a7d8-4f86-8441-1fe4811eae17" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><label data-uncovered-attr="fuzz" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInpet" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuz{()" type="tept"/></label><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><label data-entangled="b65e67fe-b029-4307-93e1-6efc83890306" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): &lt;!-- Google Analytics --&gt;<input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script>&lt;!-- Temporary fix --&gt;<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2><label data-uncovered-attr="fuzz" for="unlinkedInput" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label><title click="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2><html data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()"></entanglement-wrapper>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title><title data-entangled="aebbf2c3-7c3d-43fb-b4a8-91891ef68e38" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="tryggerFuzz()" onblur="triggerVuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper><coverage-gap-fill data-depth="5" data-entangled="65907b72-b69c-43d4-8660-2a8fe1cd7b77" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggezFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body></entanglement-wrapper><head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><head data-entangled="8ef18c84-1f6d-412a-bd02-02d476baf68e" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
&lt;!-- Appears broken in IE --&gt;<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head></body><coverage-gap-fill data-depth="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1" data-entangled="4fba7024-a02c-4bdd-9124-b2622af575ad" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><html data-uncovered-attr="fuzz" dir="ltr" lang="xx-YY" onblur="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http:/example.com/blocked.css" onabort="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="�" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz(+"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head>
<body data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="tsiggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script><script data-entangled="ed8c7b3b-0272-4da7-ad63-41a1093b4ece" data-uncovered-attr="fuzz" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<entanglement-wrapper><div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div></entanglement-wrapper>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<label data-uncovered-attr="fuzz" for="unlinkedInput" mouseover="alert('Interactive mutation at step 0');" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label> <span data-uncovered-attr="fuzz" onabort="tRiggerFuzz()" onblur="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/><br data-entangled="e78a118a-8247-4e77-9636-f7602574b99e" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><label data-entangled="5636987b-05e1-41ae-960f-978c146ec6fb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a> <!-- javascript: URI -->
<entanglement-wrapper><button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button></entanglement-wrapper><button data-entangled="2d5627ee-ad33-4fec-bc52-f0068e357798" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<entanglement-wrapper><h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2></entanglement-wrapper>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="in0ut" onabort="triggerFuzz()" onerror="triggerFuzz()" type="invalid"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="in�ut" onblur="triggerFuzz()" type="text"/><input name="inpuv" type="invalid"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onblur="triggerF�zz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<script click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        window.mutationCounter++
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onblur="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
&lt;!-- Temporary fix --&gt;<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()"><label data-uncovered-attr="fuzz" for="unlinkedInput" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label></entanglement-wrapper> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<entanglement-wrapper><input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="checkbox"/></entanglement-wrapper> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz(	">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p><p data-entangled="5f3dbc39-1341-4e1c-bace-4446f1d633ec" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" mouseover="alert('Interactive mutation at step 1');" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><a data-entangled="4b42c2a6-d7eb-4a6e-b29f-ea2448efc1a3" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p><p data-entangled="ebfea624-2fd6-4365-b592-adc1f54644ba" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="teqtAudio" onabort="triggerFuzz()" onblur="triggmrFuzz()" onerror="triggerBuzz()" src="josuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="anpup" onabort="triggerFuzz()" onblur="triggerFuxz()" type="pext"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onabort="triggerFuzz()" onblur="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" type="invalid"/><input name="inpet" type="invalid"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div><div data-entangled="b4590d32-e4d2-459d-bc25-5b5e35bae516" data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script></entanglement-wrapper><script data-entangled="d742e073-6b83-49a6-a11d-475b051de886" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body><mutation-marker data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerF�zz()">Active &lt;iframe&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
&lt;!-- Appears broken in IE --&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
&lt;!-- Appears broken in IE --&gt;<link data-uncovered-attr="fuzz" href="http://example.com/blocked.css" onabort="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="inp}t" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu|" onabort="triggerFuzz()" onblur="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        new ArrayBuffer(1e6)
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="intut" onerror="triggerFuzz()" type="text"/><input name="Input" type="number"/></form><mutation-marker data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><mutation-marker data-entangled="9a39a90e-a7d8-4f86-8441-1fe4811eae17" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/><input data-entangled="46a9f5da-ec9c-442c-912c-12a5cc890a2d" data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><label data-entangled="b65e67fe-b029-4307-93e1-6efc83890306" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script>&lt;!-- Temporary fix --&gt;<h2 data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        const res = document.querySelectorAll('*');
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2><label data-uncovered-attr="fuzz" for="unlinkedInput" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label><title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Storage Limit Test</h2><html data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()">
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()"></entanglement-wrapper>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz(!" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p><p data-entangled="e52b0a82-9fe2-42db-8830-e07e6722d3fc" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2><h2 data-entangled="1a93a2c4-0ce1-4563-a46a-288c79f41f5e" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="7" data-uncovered-attr="fuzz" onabort="triGgerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><entanglement-wrapper data-uncovered-attr="fuzz" mouseover="alert('Interactive mutation at step 1');" onabort="triggerFuzz()" onerror="triggerFuzz()"><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body></entanglement-wrapper><head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><head data-entangled="8ef18c84-1f6d-412a-bd02-02d476baf68e" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test</title>
&lt;!-- Appears broken in IE --&gt;<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head></body><html data-det-step="1" data-uncovered-attr="fuzz" dir="ltr" lang="xx-YY" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggevFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggarFuzz()" src="http://example.co�/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http:/example.com/blocked.css" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="trigger�uzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="dupliCate-structure-id" onblur="triggerFuzz()" onerror="triegerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<label data-uncovered-attr="fuzz" for="unlinkedInput" mouseover="alert('Interactive mutation at step 0');" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label> <entanglement-wrapper><span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span></entanglement-wrapper><span data-entangled="7a8b60c9-53a4-4e05-a587-bd757d127509" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInp5t" onabort="triggurFuzz()" onblur="triggerFuzz()" type="chegkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggarFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><label data-entangled="5636987b-05e1-41ae-960f-978c146ec6fb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><label data-entangled="4a377c83-cf17-4c4d-a9f7-1c8a2d59e323" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a><a data-entangled="24cd7989-c756-40f0-b63d-3e359f36a3d8" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triwgerFuzz()" onblur="triggerFu~z()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        document.querySelectorAll('*')
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="a65ef94e-4e8d-48f5-8075-340428d5b5cb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" load="function handleEvent() {
    try {
        try {
        document.querySelectorAll('*')
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="in0ut" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="invalid"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="In�ut" onblur="triggerFuzz()" type="texT"/><input name="ynput" type="number"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top:$3em;">End of Combined Page Content</p>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<entanglement-wrapper><h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2></entanglement-wrapper>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" mouseover="alert('Interactive mutation at step 1');" onblur="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="trigoerFuZz()" onblur="triggerFuzz()" onerror="TriggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
&lt;!-- Temporary fix --&gt;<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><label data-uncovered-attr="fuzz" for="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label></entanglement-wrapper> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="fe692e74-2788-45a2-830d-1b5a3b2a40ba" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><a data-entangled="4b42c2a6-d7eb-4a6e-b29f-ea2448efc1a3" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triGgerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="|riggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        const res = document.body.appendChild(document.createElement('div'));
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<entanglement-wrapper><h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2></entanglement-wrapper>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onabort="triggerFuzz()" onerror="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" type="text"/><input name="inpu4" type="text"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div><div data-entangled="b4590d32-e4d2-459d-bc25-5b5e35bae516" data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script></entanglement-wrapper><script data-entangled="d742e073-6b83-49a6-a11d-475b051de886" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body><body data-det-step="1" data-entangled="9fe91d6a-b1d6-4bbd-b6dc-7b30a998f52f" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" mouseover="alert('Interactive mutation at step 1');" onblur="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="trigoerFuZz()" onblur="triggerFuzz()" onerror="TriggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
&lt;!-- Temporary fix --&gt;<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><label data-uncovered-attr="fuzz" for="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label></entanglement-wrapper> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><a data-entangled="4b42c2a6-d7eb-4a6e-b29f-ea2448efc1a3" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triGgerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="|riggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        const res = document.body.appendChild(document.createElement('div'));
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill>&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        const res = window.mutationCounter++;
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onabort="triggerFuzz()" onerror="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" type="text"/><input name="inpu4" type="text"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div><div data-entangled="b4590d32-e4d2-459d-bc25-5b5e35bae516" data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi389" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solId blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script></entanglement-wrapper><script data-entangled="d742e073-6b83-49a6-a11d-475b051de886" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body><script data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = window.mutationCounter++;
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onblur="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<label click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" for="unlinkedInput" mouseover="alert('Interactive mutation at step 0');" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><label data-entangled="5636987b-05e1-41ae-960f-978c146ec6fb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<entanglement-wrapper><p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p></entanglement-wrapper>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onabort="triggerFuzz()" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="in0ut" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="invalid"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inqut" onerror="triggerFuzz()" type="number"/><input name="i.put" type="number"/></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onblur="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()"><br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseovep_test_abc123" onabort="trkggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10ph; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div><div data-entangled="2f72c36e-6ee5-4b0f-9a1c-6a7987f0c923" data-uncovered-attr="fuzz" id="fuzz_mouseovep_test_abc123" onabort="trkggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10ph; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p><p data-entangled="37da2519-e895-4a43-970f-827bc9e67cab" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body><html data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()"></entanglement-wrapper>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><html data-det-step="1" data-entangled="c8ad37f2-458c-48b8-b9f9-6177cb3e660f" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()"></entanglement-wrapper>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></html><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        const res = document.body.appendChild(document.createElement('div'));
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body></entanglement-wrapper><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<entanglement-wrapper><p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p></entanglement-wrapper>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body><body data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body><head data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http:/example.com/blocked.css" onblur="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head><head data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
&lt;!-- Appears broken in IE --&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
&lt;!-- Appears broken in IE --&gt;<link data-uncovered-attr="fuzz" href="http://example.com/blocked.css" onabort="triggerFuzz()" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="c1e4379a-97e5-4e3e-a01d-70c0107cf9a9" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill>&lt;!-- Temporary fix --&gt;<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-det-step="1" data-uncovered-attr="fuzz" id="preventForm" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="in0ut" onabort="triggerFuzz()" onerror="triggerFuzz()" type="invalid"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu�" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onerror="triggerFuzz()" type="number"/><input name="in`ut" type="text"/></form><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-det-step="1" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <entanglement-wrapper><input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></entanglement-wrapper></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="anput" onabort="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inp5t" onabort="triggerFuzz()" onblur="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-entangled="18b0fe70-9195-4fd5-a8eb-ee7c402f4ad0" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inrut" onabort="triggerFuzz()" type="number"/><input name="inpu|" type="number"/></form><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-det-step="1" data-uncovered-attr="fuzz" id="preventForm" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="inp}t" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inpu|" onabort="triggerFuzz()" onerror="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input data-uncovered-attr="fuzz" name="inptt" onabort="triggerFuzz()" type="invalid"/><input name="iNput" type="invalid"/></form><head data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><title data-uncovered-attr="fuzz" onabort="trhggerFuzz()" onblur="triggerFuzzh)" onerror="triggerFuzz()">ASan Stress Test</title><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><meta content="1" data-uncovered-attr="fuzz" name="mutation-round" onabort="triggerFuzz()" onblur="triggerFuzz()"/></head><span data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></span><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><h1 data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="03e26153-96c4-4ce2-b195-c76fe014808a" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1><mutation-marker data-det-step="1" data-entangled="9a39a90e-a7d8-4f86-8441-1fe4811eae17" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><h1 data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" mouseover="alert('Interactive mutation at step 1');" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><h1 data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1><audio controls="" data-det-step="1" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><pre data-det-step="1" data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><canvas data-det-step="1" data-uncovered-attr="fuzz" height="200" id="stressCanvas" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="tsiggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas><canvas data-det-step="1" data-uncovered-attr="fuzz" height="200" id="stressCanvas" onblur="triggerFuzz()" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></canvas><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><span data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></span><h1 data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1><head data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="tr�ggerFuzz()"></entanglement-wrapper>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><video controls="" data-det-step="1" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video><mutation-marker data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Active &lt;input&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><pre data-det-step="1" data-uncovered-attr="fuzz" id="log" onblur="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre><pre data-det-step="1" data-uncovered-attr="fuzz" id="pageLog" onblur="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre><video controls="" data-det-step="1" data-uncovered-attr="fuzz" id="testVideo" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></video><audio controls="" data-det-step="1" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></audio><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><pre data-det-step="1" data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onblur="triggerFuzz()">Page Log:<entanglement-wrapper><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></pre><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><head data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><a data-det-step="1" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">&lt;!-- Temporary fix --&gt;<entanglement-wrapper data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper><entanglement-wrapper data-entangled="c37c3206-e3f8-4b2a-8da8-b4130862f539" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill></a><head data-det-step="1" data-entangled="8ef18c84-1f6d-412a-bd02-02d476baf68e" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test</title>
&lt;!-- Appears broken in IE --&gt;<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><a data-det-step="1" data-uncovered-attr="fuzz" href="#" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><entanglement-wrapper data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill><mutation-marker data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Active &lt;iframe&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker><a data-det-step="1" data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><a data-det-step="1" data-entangled="41d6bdbd-0164-4bb9-8b84-8aaddd169e5e" data-uncovered-attr="fuzz" href="#" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><a data-det-step="1" data-entangled="4b42c2a6-d7eb-4a6e-b29f-ea2448efc1a3" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><entanglement-wrapper><a data-det-step="1" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a></entanglement-wrapper><a data-det-step="1" data-entangled="5e25887e-76dc-4155-95db-3d0b84a96449" data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></a><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="u" data-det-step="3" data-uncovered-attr="fuzz" load="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="5" data-det-step="�" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="tsiggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper><label data-det-step="1" data-entangled="5636987b-05e1-41ae-960f-978c146ec6fb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label></entanglement-wrapper><label data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input click="function handleEvent() {
    try {
        try {
        const res = new ArrayBuffer(1e6);
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"></entanglement-wrapper><label data-det-step="!" data-uncovered-attr="fuzz" onabort="trig�erFuzz()" onblur="t2iggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/></entanglement-wrapper><label data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="4f6b9f5c-89d3-498a-a28d-8185fc6f17c4" data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script click="alert('Interactive mutation at step 1');" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggErFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><label data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz*)" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerNuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill>&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script></entanglement-wrapper><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><label data-uncovered-attr="fuzz" for="unlinkedInput" onblur="triggerFuzz()" onerror="triggerFuzz()">Label for input:</label></entanglement-wrapper><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        document.body.appendChild(document.createElement('div'))
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><entanglement-wrapper><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><entanglement-wrapper data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper><label data-det-step="1" data-entangled="b65e67fe-b029-4307-93e1-6efc83890306" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><label data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onblur="triggerVuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-entangled="e476fbb1-3d75-45aa-b666-e83b54ee6844" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></entanglement-wrapper></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" mouseover="function handleEvent() {
    try {
        try {
        window.mutationCounter++
    } finally {
        window.lastMutation = performance.now();
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-1', performance.now().toString()); } catch(e) {}</script><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-det-step="!" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="tbiggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1" data-det-step="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="3b49beb6-1584-4308-9ba1-3576f523b13e" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><h2 data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" onerror="triggerFuzz()">Log</h2><script data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('recursive script at step 0');</script><img data-det-step="1" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></body>