<!DOCTYPE html>
<!-- Intentionally missing lang= or invalid to test localization mismatch. -->
<html dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Test Page 2 - Forms, Security, Performance, Animation</title>
  <script>
    // Attempt to load an insecure script (Mixed Content if served over HTTPS)
    // Just a comment that we can't guarantee the environment is HTTPS,
    // but if your test setup is with HTTPS, it should detect it as mixed.
    var script = document.createElement('script');
    script.src = "http://example.com/insecure.js";
    document.head.appendChild(script);

    // Large array to push some memory usage
    // (We won't truly cause an OOM unless the environment is extremely tight,
    // but we trigger the memory checks.)
    let bigArray = [];
    for(let i=0; i<500000; i++) {
      bigArray.push(Math.random());
    }
    console.log("Allocated bigArray with 500k elements to stress memory usage.");

    // Artificial performance slowdown
    // We do a busy loop for ~1 second
    const startPerf = performance.now();
    while (performance.now() - startPerf < 1000) { /* block main thread 1 sec */ }

    // Cookie test
    document.cookie = "test_page_2_cookie=some_value; path=/;";
  </script>
  <style>
    /* Simple CSS animation that changes background color repeatedly to cause repeated rendering frames. */
    @keyframes flickerTest {
      0% { background-color: #ff9999; }
      50% { background-color: #9999ff; }
      100% { background-color: #ff9999; }
    }
    .flicker {
      animation: flickerTest 0.5s infinite;
    }
  </style>
</head>
<body>

  <!-- Simple container to show animation glitch detection -->
  <div class="flicker" style="width:200px;height:100px;margin:20px;">
    Flickering box to test animation glitch detection.
  </div>

  <!-- Form with JavaScript to override submission (testing event handling) -->
  <form id="testForm">
    <label for="firstName">Name:</label>
    <input type="text" id="firstName">
    <button type="submit">Submit</button>
  </form>

  <script>
    // Another concurrency test: addCookie & removeCookie quickly
    // (We do add_cookie logic from JS perspective)
    document.cookie = "test_page_2_cookie_delete=delete_me; path=/;";
    // Then immediately try to remove it (can't remove from JS alone unless we set an expired date)
    document.cookie = "test_page_2_cookie_delete=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";

    // Form submission event:
    const f = document.getElementById("testForm");
    f.addEventListener('submit', function(evt) {
      // Prevent actual submission, to trigger an anomaly
      evt.preventDefault();
      console.warn("Form submission was prevented in test_page_2!");
    });

    // Simple event handling checks
    f.addEventListener('mouseover', () => {
      f.dataset.mouseoverTest = "true";
    });
  </script>

  <!-- Non-secure images or resources to provoke "mixed content" if your environment is over HTTPS -->
  <img src="http://example.com/insecure_image.jpg" alt="Mixed Content Test" style="display:none;">

  <!-- Performance test: load a large or nonexistent resource (like a big .js or .css) to create slow resource logs -->
  <script src="non_existent_huge_resource.js"></script>

</body>
</html>
