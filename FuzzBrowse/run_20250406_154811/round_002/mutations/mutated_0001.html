<!DOCTYPE html>

<head data-uncovered-attr="fuzz" onabort="triggerFuzz()">&lt;!-- Appears broken in IE --&gt;<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">hang / timeout demo<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></title><title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">asan crash demo (uaf attempt)<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></title><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"> body { font-size: large !important} <coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></script></coverage-gap-fill><!-- Google Analytics --><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></style><meta content="default-src 'self' 'unsafe-inline'" data-uncovered-attr="fuzz" http-equiv="Content-Security-Policy" onblur="triggerFuzz()"/><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill>&lt;!-- Google Analytics --&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">console.log('Mutation: ');<coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script><coverage-gap-fill data-depth="2" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="4">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script>console.log('recursive script at step 0');</script></coverage-gap-fill><meta content="1" data-uncovered-attr="fuzz" name="mutation-round" onblur="triggerFuzz()"/><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('Mutation: ');</script><coverage-gap-fill data-depth="2"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><script>function triggerFuzz() {}</script><script async="">
        window.__jsCoverage = new Proxy({}, {
            get(t, p) { return t[p] || 0 },
            set(t, p, v) { t[p] = (t[p] || 0) + 1; return true }
        });
        </script></head><body data-uncovered-attr="fuzz" onblur="triggerFuzz()"><html data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onabort="triggerFuzz()">
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">hang / timeout demo<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="7"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></title>
<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="6"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></head>
<body data-uncovered-attr="fuzz" onblur="triggerFuzz()">
&lt;!-- Temporary fix --&gt;<h1 data-uncovered-attr="fuzz" onerror="triggerFuzz()">potential hang trigger<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">this script might make the browser unresponsive.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></p>
<div data-uncovered-attr="fuzz" id="outputArea" onabort="triggerFuzz()" onblur="triggerFuzz()" style="height: 100px; overflow: auto; border: 1px solid black;"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></div>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        let counter = 0;
        function recursiveDomFiller() {
                        
            counter++;
            let output = document.getElementById('outputArea');
            if (output) {
                                let newItem = document.createElement('span');
                newItem.textContent = ' item ' + counter + ' (' + Math.random() + ') ';
                                for (let i=0; i<5; i++) {                     output.appendChild(newItem.cloneNode(true));
                }
                                output.scrollTop = output.scrollHeight;
            }

            if (counter % 100 === 0) {
                 console.log('hang check counter:', counter);
            }

                                                setTimeout(recursiveDomFiller, 0);
        }

        console.log('starting recursive dom filler...');
        recursiveDomFiller(); 
                try { eval('console.log("mutated eval ' + Math.random() + '")'); } catch(e){}
        document.body.style.backgroundColor = 'light' + String.fromCharCode(20) + 'blue';

    <coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script>
<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script><script data-entangled="b83f2c5d-f292-4e3e-a697-3ee6aca78d5a" data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></html><html data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onblur="triggerFuzz()">
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">asan crash demo (uaf attempt)<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="7"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></title>
<!-- simulate mutation adding weird styles -->
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"> body { font-size: large !important} <coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');<coverage-gap-fill data-depth="7"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></style>
<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="6"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></head>
<body data-uncovered-attr="fuzz" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()">potential uaf trigger<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<div data-uncovered-attr="fuzz" id="elem_to_remove" onerror="triggerFuzz()">i might go away soon...<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></div>
<button data-uncovered-attr="fuzz" id="actionBtn" onabort="triggerFuzz()" onerror="triggerFuzz()">do something<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></button>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
                let potentiallyDanglingRef = document.getElementById('elem_to_remove');
        console.log('got initial reference:', potentiallyDanglingRef);

                        function removeElement() {
            try {
                let target = document.getElementById('elem_to_remove');
                if (target && target.parentNode) {
                    console.log('removing element now...');
                    target.parentNode.removeChild(target);
                                    } else {
                    console.log('element already gone or no parent?');
                }
            } catch (e) { console.error('error removing:', e); }
        }
        setTimeout(removeElement, 50); 
                function useReferenceLater() {
            try {
                console.log('trying to use reference after delay...');
                                                let currentText = potentiallyDanglingRef.textContent;
                potentiallyDanglingRef.innerHTML = 'accessed after free? ' + Math.random();
                potentiallyDanglingRef.setAttribute('data-mutated-later', 'true');
                console.log('successfully(?) used dangling ref. content:', currentText);
            } catch (e) {
                                console.error('error using reference (might be expected if no crash):', e);
            }
        }
                        setTimeout(useReferenceLater, 200);         document.getElementById('actionBtn').onclick = useReferenceLater;

                let noisyDiv = document.createElement('d' + String.fromCharCode(1) + 'v');         noisyDiv.textContent = 'mutation noise ' + Date.now();
        document.body.appendChild(noisyDiv);
        document.body.setAttribute('data-bitwise-corrupt', 'val' + String.fromCharCode(10) + 'ue');

    <coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script>
<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><entanglement-wrapper><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script><coverage-gap-fill data-depth="6"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></html><script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}<coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script>&lt;!-- Google Analytics --&gt;<coverage-gap-fill data-depth="2" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script><script data-entangled="3463ed47-adef-4d97-8303-7535d46515b8" data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="2"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></body><coverage-gap-fill data-depth="1" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');<coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1"><script>console.log('recursive script at step 0');</script></coverage-gap-fill>