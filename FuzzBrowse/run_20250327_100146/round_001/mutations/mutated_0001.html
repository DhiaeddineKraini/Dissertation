<!DOCTYPE html>

<head data-uncovered-attr="fuzz" onerror="triggerFuzz()"><title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined</title><title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">ASan Stress Test</title><style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><style data-uncovered-attr="fuzz" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><style data-entangled="39cd04c6-a793-4df7-bf67-7a3f77469089" data-uncovered-attr="fuzz" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style><meta content="default-src 'self' 'unsafe-inline'" data-uncovered-attr="fuzz" http-equiv="Content-Security-Policy" onerror="triggerFuzz()"/><meta content="1" data-uncovered-attr="fuzz" name="mutation-round" onblur="triggerFuzz()"/><script>function triggerFuzz() {}</script><script async="">
        window.__jsCoverage = new Proxy({}, {
            get(t, p) { return t[p] || 0 },
            set(t, p, v) { t[p] = (t[p] || 0) + 1; return true }
        });
        </script></head><body data-uncovered-attr="fuzz" onblur="triggerFuzz()"><html data-uncovered-attr="fuzz" dir="ltr" lang="xx-YY" onabort="triggerFuzz()" onblur="triggerFuzz()">
<head data-uncovered-attr="fuzz" onblur="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http://example.com/blocked.css" onerror="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head>
<body data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onabort="triggerFuzz()" onerror="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<entanglement-wrapper><div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onblur="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()"/>
<label data-uncovered-attr="fuzz" for="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()">Label for input:</label> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()">Input:<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onerror="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()"/><br data-entangled="384cd151-ae05-46d7-acd2-39c916fec3a9" data-uncovered-attr="fuzz" onabort="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<a data-uncovered-attr="fuzz" href="#" onblur="triggerFuzz()">Click here<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" load="alert('Interactive mutation at step 0');" onblur="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Potential XSS Patterns</h2>
<img data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onerror="triggerFuzz()">JS Link<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.&lt;!-- Google Analytics --&gt;<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onblur="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onblur="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="inpwt" onerror="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input name="inpuu" type="invalid"/><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></form>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onabort="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" onblur="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
&lt;!-- Google Analytics --&gt;<script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script><script data-entangled="3e83bf7d-8f14-46c4-a889-3314b8afe1f4" data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body>
<coverage-gap-fill data-depth="" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></html><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><body data-uncovered-attr="fuzz" onabort="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Comprehensive Anomaly Test - Combined Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<pre data-uncovered-attr="fuzz" id="pageLog" onblur="triggerFuzz()">Page Log:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()">
                function logStatus(message) {
            console.log(`[Status] ${message}`);
            const logEl = document.getElementById('pageLog');
            if (logEl) {
                logEl.textContent += '\n' + message;
                logEl.scrollTop = logEl.scrollHeight;             }
        }
        logStatus("Combined page script started.");
    </script>
<!-- === From Page 1: Structure, Basic JS, Security, Accessibility, Localization === -->
<!-- INTENTIONAL: Console Error API -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()">Console API Errors/Warnings</h2>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()">
        console.error("Deliberate console.error message!");
        console.warn("Deliberate console.warn message!");
    </script>
<!-- INTENTIONAL: Security Headers (missing - always triggers for file://) -->
<!-- Handled implicitly by file:// protocol -->
<!-- INTENTIONAL: DOM Structure (Duplicate ID + Blocking Script) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()">DOM Structure Issues (Combined)</h2>
<div data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onblur="triggerFuzz()">First element with this ID</div>
<p data-uncovered-attr="fuzz" id="duplicate-structure-id" onabort="triggerFuzz()" onerror="triggerFuzz()">Second element with this ID (duplicate_ids)</p>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
                logStatus("This is a blocking script in the body.");
    </script>
<!-- INTENTIONAL: Accessibility (Axe checks) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Accessibility Issues</h2>
<img data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/> <!-- Missing alt -->
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<label data-uncovered-attr="fuzz" for="unlinkedInput" onabort="triggerFuzz()" onblur="triggerFuzz()">Label for input:</label> <span data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Input:<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></span> <input data-uncovered-attr="fuzz" name="testInput" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text"/> <!-- Input not linked via for/id -->
<input data-uncovered-attr="fuzz" id="unlinkedInput" onabort="triggerFuzz()" type="checkbox"/> <!-- Checkbox might need better context/grouping -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()"/>
<button data-uncovered-attr="fuzz" onerror="triggerFuzz()">Generic Button</button> <!-- Missing type="button" -->
<br data-uncovered-attr="fuzz" onerror="triggerFuzz()"/>
<div class="low-contrast" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Low contrast text example</div> <!-- Low contrast -->
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<div data-uncovered-attr="fuzz" onblur="triggerFuzz()" role="button" tabindex="0">Div acting as button (incorrect role usage)</div>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<entanglement-wrapper><a data-uncovered-attr="fuzz" href="#" onerror="triggerFuzz()">Click here<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></a><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper> <!-- Insufficient link text -->
<!-- INTENTIONAL: Localization (Combined) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Localization Issues</h2>
<!-- Missing lang/invalid lang/dir mismatch handled by <html> tag -->
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Untranslated placeholder: Lorem ipsum dolor sit amet. (untranslated_text)</p>
<label data-uncovered-attr="fuzz" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label> <!-- invalid_date_format (text) -->
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label> <!-- invalid_date_format (date) -->
<!-- INTENTIONAL: Potential XSS Patterns -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()">Potential XSS Patterns</h2>
<entanglement-wrapper><img data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></entanglement-wrapper> <!-- onerror attribute -->
<a data-uncovered-attr="fuzz" href="javascript:logStatus('XSS pattern: javascript: URI executed')" onabort="triggerFuzz()">JS Link<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></a> <!-- javascript: URI -->
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()" onclick="let result = eval('1+1'); logStatus('XSS pattern: eval executed, result=' + result)" onerror="triggerFuzz()">Run Eval</button> <!-- eval() call -->
<!-- INTENTIONAL: JS Syntax Error for Console Check -->
<h2 data-uncovered-attr="fuzz" onerror="triggerFuzz()">JavaScript Syntax Error</h2>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">
        logStatus("Script before syntax error...");
                logStatus("Script executed *after* potential syntax error location.");     </script>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()">(Syntax error line is commented out by default to allow subsequent tests to run reliably. Uncomment to test.)</p>
<!-- INTENTIONAL: Storage (Invalid Cookie Domain for file://) -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Storage (Cookie Test)</h2>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">The detection script's internal `check_storage` will attempt to add/delete a cookie and likely trigger an 'invalid cookie domain' error/warning when run via file://.</p>
<!-- INTENTIONAL: Media Playback Errors -->
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Media Playback Errors</h2>
<video controls="" data-uncovered-attr="fuzz" id="testVideo" onblur="triggerFuzz()" onerror="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-entangled="59acde99-8d16-4b91-8131-abe55e35982d" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></video>
<audio controls="" data-uncovered-attr="fuzz" id="testAudio" onabort="triggerFuzz()" onblur="triggerFuzz()" src="nosuch/audio.mp3">Audio not supported.<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></audio>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        setTimeout(() => {
            try {
                const video = document.getElementById('testVideo');
                const audio = document.getElementById('testAudio');
                logStatus(`Media Check: Video readyState: ${video?.readyState}, error: ${video?.error?.code}`);
                logStatus(`Media Check: Audio readyState: ${audio?.readyState}, error: ${audio?.error?.code}`);
                                if(video && typeof video.play === 'function') video.play().catch(e => logStatus(`Video play attempt error: ${e.message}`));
                if(audio && typeof audio.play === 'function') audio.play().catch(e => logStatus(`Audio play attempt error: ${e.message}`));
            } catch(e) { logStatus(`Error checking media state: ${e.message}`); }
        }, 2000);      </script>
<!-- === From Page 2: Performance, Resources, Storage Limits, Events, Complex DOM === -->
<!-- INTENTIONAL: Performance, CPU, JS Heap, Long Tasks -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Performance &amp; Resource Stress</h2>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Attempting heavy computations and allocations...</p>
<!-- Script for stressTest defined below -->
<!-- INTENTIONAL: DOM Structure (Deep Nesting & Large Size) -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">DOM Structure Stress</h2>
<div data-uncovered-attr="fuzz" id="deep-nesting-container" onblur="triggerFuzz()" onerror="triggerFuzz()">Root for deep nesting</div>
<div data-uncovered-attr="fuzz" id="large-dom-container" onerror="triggerFuzz()">Root for large DOM</div>
<!-- Script for domStress defined below -->
<!-- INTENTIONAL: Storage Limit -->
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Storage Limit Test</h2>
<!-- Script for storageLimitTest defined below -->
<!-- INTENTIONAL: Event Handling (Form Prevented & Test Targets) -->
<h2 data-uncovered-attr="fuzz" onerror="triggerFuzz()">Event Handling (Specific Cases)</h2>
<form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onabort="triggerFuzz()" onblur="triggerFuzz()">
<label data-uncovered-attr="fuzz" onblur="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onblur="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name=")nput" onblur="triggerFuzz()" type="text"/><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input name="ioput" type="invalid"/><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></form>
<br data-uncovered-attr="fuzz" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic click test -->
<button data-uncovered-attr="fuzz" id="fuzz_click_test_def456" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid green; padding: 10px;">
        Target for Successful Click Test
    </button>
<br data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for successful synthetic mouseover test -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onblur="triggerFuzz()" onerror="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div>
<br data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/><br data-entangled="498dbec7-6321-448e-b039-2c4c6e2f7190" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- Target for *failing* synthetic mouseover test (no handler) -->
<div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_abc123" onabort="triggerFuzz()" style="border: 1px dashed red; padding: 10px; margin-top: 10px;">
         Target for Failing Mouseover Check (No Handler Attached by Test Page)
     </div>
<!-- Script for event handlers defined below -->
<!-- === Scripts for Page 2 Functionality (Placed towards the end) === -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script><script data-entangled="d5186a65-61be-44a0-8d85-43fd1d159fcb" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p>
</body><head data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<!-- INTENTIONAL: CSP to trigger violations (blocks example.com) -->
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Comprehensive Anomaly Test - Combined</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: sans-serif; padding-bottom: 100px; /* Ensure space for absolutely positioned elements if any */ }
        h2 { margin-top: 2em; border-top: 1px solid #ccc; padding-top: 0.5em;}
        pre#pageLog { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.9em; }
        /* Accessibility */
        .low-contrast { color: #aaa; background-color: #fff; padding: 5px; border: 1px solid #eee; }
        /* DOM Stress */
        #deep-nesting-container div { border-left: 1px solid #eee; margin-left: 10px; padding: 1px 0 1px 5px; font-size: 0.8em;}
        #large-dom-container span { display: inline-block; width: 1px; height: 1px; margin: 0; padding: 0; overflow: hidden;}
        /* Canvas */
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
<!-- INTENTIONAL: Script with runtime error for console check -->
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()">
        console.warn("Running script with intentional runtime error...");
        try {
            console.log(someUndefinedVariable);         } catch (e) {
            console.error("Caught Expected Error (Runtime):", e.message);
        }
    </script>
<!-- INTENTIONAL: Script loaded over HTTP (insecure script) AND blocked by CSP -->
&lt;!-- Google Analytics --&gt;<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" src="http://example.com/blocked.js"></script>
<!-- INTENTIONAL: Resource likely not present AND from origin not allowed by CSP -->
<img alt="Placeholder Image" data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" src="http://via.placeholder.com/50"/> <!-- Allowed by img-src -->
<link data-uncovered-attr="fuzz" href="http://example.com/blocked.css" onabort="triggerFuzz()" rel="stylesheet"/><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill> <!-- Blocked by default-src/style-src -->
</head><form action="javascript:logStatus('Form submitted - THIS SHOULD NOT HAPPEN')" data-uncovered-attr="fuzz" id="preventForm" onblur="triggerFuzz()" onerror="triggerFuzz()">
<label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text"/></label>
<button data-uncovered-attr="fuzz" onabort="triggerFuzz()" type="submit">Submit (Will be Prevented)</button>
<input data-uncovered-attr="fuzz" name="knput" onabort="triggerFuzz()" type="number"/><coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><input name="Input" type="text"/><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></form><label data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Date (Input): <input data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" type="date" value="2025/03/27"/></label><mutation-marker data-uncovered-attr="fuzz" onabort="triggerFuzz()">Active &lt;li&gt; insertion<coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker>&lt;!-- Temporary fix --&gt;<label data-uncovered-attr="fuzz" onblur="triggerFuzz()">Test Input: <input data-uncovered-attr="fuzz" name="formInput" onerror="triggerFuzz()" type="text"/></label><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><label data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">Date (Invalid Format): <input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/></label><img data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()" src="invalid.jpg"/><span data-uncovered-attr="fuzz" onblur="triggerFuzz()">Input:<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></span><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><p data-uncovered-attr="fuzz" onerror="triggerFuzz()" style="margin-top: 3em;">End of Combined Page Content</p><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">
                function stressTest() {
            logStatus("Starting Performance/Resource Stress Test...");
            const start = performance.now();
            try {
                                logStatus("Running CPU-intensive loop...");
                const loopDuration = 1000;                 let counter = 0;
                const loopStart = performance.now();
                while (performance.now() - loopStart < loopDuration) { counter++; }
                logStatus(`CPU loop finished after ${loopDuration}ms. Counter: ${counter}`);

                                logStatus("Allocating large data structure...");
                const elementCount = 80000;                 const stringSize = 400;                   window.largeGlobalData = [];
                for (let i = 0; i < elementCount; i++) {
                    window.largeGlobalData.push({ id: i, text: "X".repeat(stringSize), value: Math.random() });
                }
                logStatus(`Allocated ${elementCount} objects for JS Heap check.`);
            } catch (e) {
                logStatus(`Error during stress test: ${e.message}`);
                 window.largeGlobalData = null;
            }
            const end = performance.now();
            logStatus(`Performance/Resource Stress Test completed in ${(end - start).toFixed(2)} ms.`);
        }

                function domStress() {
            logStatus("Starting DOM Stress Test...");
            try {
                                  logStatus("Creating deeply nested elements...");
                 let parent = document.getElementById('deep-nesting-container');
                 const depth = 18;                  for (let i = 0; i < depth; i++) {
                     const div = document.createElement('div');
                     div.textContent = `Level ${i+1}`;
                                          if (i === 16 || i === 17) div.id = 'deep-duplicate-id';
                     parent.appendChild(div);
                     parent = div;
                 }
                 logStatus(`Created ${depth} levels of nesting.`);

                                  logStatus("Creating large number of elements...");
                 const container = document.getElementById('large-dom-container');
                 const nodeCount = 5500;                  for (let i = 0; i < nodeCount; i++) {
                     container.appendChild(document.createElement('span'));
                 }
                 logStatus(`Created ${nodeCount} span elements.`);
            } catch (e) {
                 logStatus(`Error during DOM stress: ${e.message}`);
            }
            logStatus("DOM Stress Test finished.");
        }

                function storageLimitTest() {
            logStatus("Starting Storage Limit Test...");
            try {
                const keyPrefix = "storage_filler_";
                const itemSize = 1024 * 100;                 const value = "S".repeat(itemSize);
                let i = 0;
                while(i < 70) {                      localStorage.setItem(keyPrefix + i, value);
                     i++;
                     if (i % 10 === 0) logStatus(`Storage Limit: Stored item ${i}...`);
                }
                 logStatus(`Storage Limit Test: Successfully stored ${i} items without error.`);
            } catch (e) {
                 logStatus(`Storage Limit Test: Caught expected error: ${e.name} - ${e.message}`);
                 console.error("Storage Quota Error:", e);             }
             logStatus("Storage Limit Test finished.");
        }

                function setupEventHandlers() {
             logStatus("Setting up specific event handlers...");
                         const form = document.getElementById('preventForm');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    logStatus("Form submission PREVENTED successfully by JS.");
                    console.warn("Form submission prevented anomaly trigger.");                 });
            } else { logStatus("Error: Could not find #preventForm"); }

                        const clickTarget = document.getElementById('fuzz_click_test_def456');
            if (clickTarget) { clickTarget.addEventListener('click', function() { this.setAttribute('data-clicked', 'true'); logStatus("#fuzz_click_test_def456 was clicked."); }); }
            const mouseoverTarget = document.getElementById('fuzz_mouseover_test_ghi789');
            if (mouseoverTarget) { mouseoverTarget.addEventListener('mouseover', function() { this.setAttribute('data-mouseover', 'true'); logStatus("#fuzz_mouseover_test_ghi789 mouseover occurred."); }); }
             logStatus("Specific event handlers set up.");
        }

                        window.addEventListener('load', () => {
            logStatus("Window loaded. Starting tests sequentially...");
            setTimeout(() => {
                 stressTest();                  setTimeout(() => {
                     domStress();                      setTimeout(() => {
                         storageLimitTest();                                               }, 500);                  }, 500);             }, 200); 
                        setupEventHandlers();
        });

    </script><input data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()" type="text" value="31/12/2025"/><script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">try { document.currentScript.parentNode.setAttribute('data-adv-entangle-0', performance.now().toString()); } catch(e) {}</script><div data-uncovered-attr="fuzz" id="fuzz_mouseover_test_ghi789" onblur="triggerFuzz()" style="border: 2px solid blue; padding: 10px; margin-top: 10px;">
         Target for Successful Mouseover Test
     </div><video controls="" data-uncovered-attr="fuzz" id="testVideo" onblur="triggerFuzz()" src="nonexistent/video.mp4" width="250">Video not supported.<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></video><mutation-marker data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Active &lt;p&gt; insertion<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></mutation-marker>&lt;!-- Appears broken in IE --&gt;<html data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<head data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head>
<body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1><h1 data-entangled="3fd09cc9-f99a-47d5-810b-4b78bdc07b43" data-uncovered-attr="fuzz" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onabort="triggerFuzz()" onblur="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onblur="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="200" id="stressCanvas" onerror="triggerFuzz()" width="400"><coverage-gap-fill data-depth="5" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onerror="triggerFuzz()"><coverage-gap-fill click="function handleEvent() {
    try {
        try {
        const res = document.body.appendChild(document.createElement('div'));
        console.debug('Mutation success:', res);
    } catch(e) {
        console.warn('Mutation error:', e);
        document.dispatchEvent(new CustomEvent('mutationFailed'));
    }
    } catch(e) {
        document.body.classList.add('mutation-error');
    }
}" data-depth="5" data-uncovered-attr="fuzz" onblur="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="5"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onblur="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body>
<coverage-gap-fill data-depth="3" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="3"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></html><body data-uncovered-attr="fuzz" onabort="triggerFuzz()" onblur="triggerFuzz()">
<h1 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test Page<coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill></h1>
<p data-uncovered-attr="fuzz" onerror="triggerFuzz()">This page attempts to trigger memory corruption bugs by stressing DOM manipulation, Canvas API, and memory allocation.</p>
<p data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Check ASan logs (e.g., in `asan_logs/`) if the browser tab crashes.</p>
<h2 data-uncovered-attr="fuzz" onerror="triggerFuzz()">DOM Churn Area</h2>
<div data-uncovered-attr="fuzz" id="domContainer" onblur="triggerFuzz()"></div>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Canvas Stress Area</h2>
<canvas data-uncovered-attr="fuzz" height="280" id="stressCa.vas" onblur="triggerFuzz()" onerror="triggerFuzz()" width="480"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onabort="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4">&lt;!--[if lt IE 9]&gt; &lt;script&gt;alert('old IE')&lt;![endif]--&gt;<script>console.log('recursive script at step 0');</script></coverage-gap-fill></canvas>
<h2 data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">Log</h2>
<pre data-uncovered-attr="fuzz" id="log" onabort="triggerFuzz()" onblur="triggerFuzz()"><coverage-gap-fill data-depth="4" data-uncovered-attr="fuzz" onabort="triggerFuzz()"><script data-uncovered-attr="fuzz" onerror="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="4"><script>console.log('recursive script at step 0');</script></coverage-gap-fill></pre>
<script data-uncovered-attr="fuzz" onabort="triggerFuzz()" onerror="triggerFuzz()">
        const logElement = document.getElementById('log');
        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        let stopStress = false;
        let cycleCount = 0;
        const MAX_CYCLES = 500; 
                function stressDOM() {
            if (stopStress) return;
            log(`DOM Stress Cycle ${cycleCount}`);
            const container = document.getElementById('domContainer');
            if (!container) {
                log("Error: DOM container not found.");
                stopStress = true;
                return;
            }

            try {
                                for (let i = 0; i < 100; i++) {
                    const elType = Math.random() < 0.5 ? 'div' : 'span';
                    const el = document.createElement(elType);
                    el.textContent = `Node ${cycleCount}-${i} (${Math.random().toString(36).substring(2)})`;
                                        if (Math.random() < 0.1) {
                        el.setAttribute('data-random', Math.random());
                        el.style.color = Math.random() < 0.5 ? 'red' : 'blue';
                    }
                    container.appendChild(el);
                }

                                while (container.children.length > 200) {                     container.removeChild(container.firstElementChild);
                }

                                if (cycleCount % 10 === 0) {
                    log("Triggering layout read...");
                    container.getBoundingClientRect();
                }

            } catch (e) {
                log(`DOM Stress Error: ${e.message}`);
                            }
        }

                function stressCanvas() {
            if (stopStress) return;
            log(`Canvas Stress Cycle ${cycleCount}`);
            const canvas = document.getElementById('stressCanvas');
            if (!canvas || !canvas.getContext) {
                 log("Error: Canvas not found or context unavailable.");
                 stopStress = true;
                 return;
            }
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            try {
                                 for (let i = 0; i < 50; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.random() * 0.5 + 0.2;
                    ctx.fillStyle = `hsl(${Math.random()*360}, 80%, 50%)`;
                    ctx.translate(Math.random() * w, Math.random() * h);
                    ctx.rotate(Math.random() * Math.PI * 2);

                                        if (Math.random() < 0.3) {
                        ctx.fillRect(-20, -20, 40, 40);
                    } else if (Math.random() < 0.6) {
                        ctx.beginPath();
                        ctx.arc(0, 0, Math.random() * 20 + 5, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                         ctx.beginPath();
                         ctx.moveTo(0, 0);
                         ctx.bezierCurveTo(Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20, Math.random()*40-20);
                         ctx.lineTo(Math.random()*40-20, Math.random()*40-20);
                         ctx.closePath();
                         ctx.fill();
                         ctx.stroke();
                    }
                    ctx.restore();
                }

                                 if (cycleCount % 20 === 0) {
                     log("Reading canvas pixels...");
                     let imageData = ctx.getImageData(0, 0, 10, 10);                  }

                                  if (cycleCount % 50 === 3) {
                     log("Clearing canvas...");
                     ctx.clearRect(0, 0, w, h);
                 }

            } catch (e) {
                log(`Canvas Stress Error: ${e.message}`);
            }
        }

                        let allocatedBuffers = [];
        function stressMemory() {
             if (stopStress) return;
             log(`Memory Stress Cycle ${cycleCount}`);

            try {
                                  const allocSizeMB = 30;
                 const allocSizeBytes = allocSizeMB * 1024 * 1024;
                 log(`Allocating ${allocSizeMB}MB ArrayBuffer...`);
                 let buffer = new ArrayBuffer(allocSizeBytes);
                 allocatedBuffers.push(buffer); 
                                  let view = new DataView(buffer);
                 view.setInt32(0, cycleCount);

                                  if (allocatedBuffers.length > 5) {
                     log("Removing oldest buffer reference...");
                     allocatedBuffers.shift();                  }
                 log(`Allocated ${allocSizeMB}MB. Total held buffers: ${allocatedBuffers.length}`);

            } catch (e) {
                 log(`Memory Allocation Error: ${e.message}`);
                                  allocatedBuffers = [];
                                              }
        }

                function runStressCycle() {
            if (stopStress || cycleCount >= MAX_CYCLES) {
                 log(`Stress testing stopped. Reached cycle ${cycleCount}.`);
                 return;
            }
            cycleCount++;

                        stressDOM();
            stressCanvas();
            stressMemory(); 
                        requestAnimationFrame(runStressCycle);         }

                window.onload = () => {
            log("Starting ASan stress test...");
                        setTimeout(() => {
                 requestAnimationFrame(runStressCycle);
            }, 500);
        };

                window.stopTest = () => {
            stopStress = true;
            log("Manual stop requested.");
        };

    </script>
</body><head data-uncovered-attr="fuzz" onabort="triggerFuzz()">
<meta charset="utf-8" data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()"/>
<title data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">ASan Stress Test</title>
<style data-uncovered-attr="fuzz" onblur="triggerFuzz()" onerror="triggerFuzz()">
        body { font-family: monospace; }
        #domContainer { border: 1px solid #ccc; min-height: 50px; max-height: 200px; overflow-y: scroll; margin-bottom: 10px; }
        #log { border: 1px solid #eee; background-color: #f8f8f8; height: 150px; overflow-y: scroll; padding: 5px; }
        canvas { border: 1px solid blue; margin-bottom: 10px; }
    </style>
</head></body><coverage-gap-fill data-depth="1" data-uncovered-attr="fuzz" onerror="triggerFuzz()"><script data-uncovered-attr="fuzz" onblur="triggerFuzz()">console.log('recursive script at step 0');</script></coverage-gap-fill><coverage-gap-fill data-depth="1"><script>console.log('recursive script at step 0');</script></coverage-gap-fill>