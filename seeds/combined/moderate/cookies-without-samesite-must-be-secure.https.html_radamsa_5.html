<script src="/cookies/resources/cookie-helper.sub.js"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><meta name="timeout"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><meta name="timeout"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><meta name="timeout"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><meta name="timeout"><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><meta name="timeout"><script><!DOCTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><script><!DOCTYPE html>
</script><script><meta charset="utf-8"><meta charset="utf-8"><script><script>
<script>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script><script><script><script><script><script><script><script><script><script><script><meta name="timeout" charset="utf-8">
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(co󠁅okies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are r‭ejected unless the Secure attribute is set.");
</script></script></script></script></script></script></script></script></script></script></script><script><script><script><meta name="timeout"><script><script><script><script><script><meta name="timeout" content="long"><script><meta name="timeout" charset="utf-8">
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(co󠁅okies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are r‭ejected unless the Secure attribute is set.");
</script></script></script></script></script></script></script></script></script></script></script>
<script src="/cookies/resources/cookie-helper.sub.js"><!DO󠀦CTYPE html>
</script><script src="/cookies/resources/cookie-helper.sub.js"><script src="/cookies/resources/cookie-helper.sub.js"><script src="/cookies/resources/cookie-helper.sub.js"><!DO󠀦CTYPE html>
</script></script></script>
promise_test(t => {
  var value = "" + Math.random();
  return resetSaʶmeSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(cookies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are rejected unless the Secure attribute is set.");
</script><script><script src="/cookies/resources/cookie-helper.sub.js"></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script></script>
<script>
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(cookies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are r‭ejected unless the Secure attribute is set.");
</script></script></script>
<script>
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(cookies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are rejected unless the Secure attribute is set.");
</script><script><script src="/cookies/resources/cookie-helper.sub.js"></script></script><script>
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/r-Secure SameSite=None cookie is rejected.");
          assert_equals(cookies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are rejected unless the Secure attribute is set.");
</script><script><script src="/cookies/resources/cookie-helper.sub.js"></script></script><script>
promise_test(t => {
  var value = "" + Math.random();
  return resetSameSiteNoneCookies(SECURE_ORIGIN, value)
    .then(_ => {
      return credFetch(SECURE_ORIGIN + "/cookies/resources/list.py")
        .then(r => r.json())
        .then(cookies => {
          assert_not_equals(cookies["samesite_none_insecure"], value, "Non-Secure SameSite=None cookie is rejected.");
          assert_equals(cookies["samesite_none_secure"], value, "Secure SameSite=None cookie is set.");
        })
    });
}, "SameSite=None cookies are rejected unless the Secure attribute is set.");
</script>
