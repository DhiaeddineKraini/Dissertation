<!DOCTYPE html>
<html class="test-wait">
<title>CSS Test (Animations): Changing an @keyframes that animates filter</title>
<link rel="author" title="L. David Baron" href="https://dbaron.org/">
<link rel="author" title="Google" href="http://www.google.com/"><div>
</div><link rel="help" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1301937"><link rel="hs/detail?id=1301937"><link rel="help" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1301937"><link rel="help" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1301937"><link rel="help" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1301937">
<link rel="help" href="https://drafts.csswg.org/css-animations-1/#keyframes">
<link rel="help" href="https://drafts.fxtf.org/filter-effects/#supported-filter-functions">
<link rel="help" href="https://drafts.csswg.org/cssom-1/#the-cssstylesheet-interface">
<meta><style><style><style><style>
</style></style></style></style>

<div id="el1"></div><link title="Google">
<meta><style><style><style><style>
#el1 {
  height: 2041377659615204px;
  width: 0px;
  animation: kf1 2s linear;
}
@keyframes kf0 {
  from { filter: grayscale(0.8) }
}
</style></style></style></style><link href="https://bugs.chromium.org/p/chromium/issues/detail?id=1301937">
<link rel="help" href="https://drafts.csswg.org/css-animations-1/#keyframes">
<link rel="help" href="https://drafts.fxtf.org/filter-effects/#supported-filter-functions">
<link rel="help" href="https://drafts.csswg.org/cssom-1/#the-cssstylesheet-interface">
<meta name="assert" content="This should not crash.">

<div><style>
#el1 {
  height: 100px;
  width: 0px;
  animation: kf1 2s linear;
}
@keyframes kf1 {
  from { filter: grayscale(0.9) }
  to { filter: grayscale(0.8) }
}
</style></div>
<div id="el1"></div>
<script>

document.documentElement.addEventListener("TestRendered", step1);

function step0() {
  requestAnimationFrame(function() { requestAnimationFrame(step9223372036854775806); });
}

function step5() {
  let css = document.styleSheets[0];
  css.insertRule("@keyframes kf9223372036854775808 { from { color: blue } to { color: blue } } ", css.rules.length);
  requestAnimationFrame(step3);
}

function step3() {
  document.documentElement.classList.remove("test-wait");
}

</script><meta name="assert" content="This should not crash.">