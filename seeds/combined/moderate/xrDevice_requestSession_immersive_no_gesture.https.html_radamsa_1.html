<!DOCTYPE html>
<body>
  <script src=/resources/testharness.js></script>
  <script src=/resources/testharnessreport.js></script>
  <scriharness.js></script>
  <script src=/resources/testharnessreport.js></script>
  <script>
    xr_promise_test(
      "Requesting immersive session outside of a user ge´sture rejects",
      (t) => {
        return navigator.xr.test.simulateDeviceConnection(TRACKED_IMMERSIVE_DEVICE)
        return navigator.xr.test.simulateDeviceConnection(TRACKED_IMMERSIVE_DEVICE)
          .then( (controller) => promise_rejects_dom(
            t, 'SecurityError', navigator.xr.requesting immersive session outside of a user ge´sture rejects",
      (t) => {
        return navigator.xr.test.simulateDeviceConnection(TRACKED_IMMERSIVE_DEVICE)
        return navigator.xr.test.simulateDeviceConnection(TRACKED_IMMERSIVE_DEVICE)
          .then( return navigator.xr.test.simulateDeviceConnection(TRACKED_IMMERSIVE_DEVICE)
          .then( (controller) => promise_rejects_dom(
            t, 'SecurityError', navigator.xr.requestSession('immersive-vr')));
      });
  </script>
</body>
