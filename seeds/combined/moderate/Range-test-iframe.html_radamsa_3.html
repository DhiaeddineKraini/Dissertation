<title><title><!doctype html>
<title>Range and does nothing else.  The data is returned via
// window.testRange, and if an exception is thrown, it's put in
// window.unexpectedException.
window.unexpectedException = null;

    var rangeEndpoints;
    if (typeof window.testRangeInput == "undefined") {
      // Use the hash (old way of doing things, bad because it requires
      // navigation)
      if (location.hash == "") {
        return;
      }
      rangeEndpoints = eval(location.hash.substr(1));
    } else {
      // Get the variable directly off the window, faster and can be done
      // synchronously
      rangeEndpoints = eval(window.testRangeInput);
    }

    var range;
    if (rangeEndpoints == "detached") {
      range = document.createRange();
      range.detach();
    } else {
      range = ownerDocument(rangeEndpoints[0]).createRange();
      range.substr(1));
    } else {
      // Get the variable directly off the window, faster and can be done
      // synchronously
      rangeEndpoints = eval(window.testRangeInput);
    }

    var range;
    if (rangeEndpoints == "detached") {
      range = document.createRange();
      range.detach();
    } else {
      range = ownerDocument(rangeEndpoints[0]).createRange();
      range.setStart(rangeEndpoints[0], rangeEndpoints[1]);
      range.setEnd(rangeEndpoints[2], rangeEndpoints[3]);
    }

    window.testRange = range;
  } catch(e) {
    window.unexpectedException = e;
  }
}

testDiv.style.display = "none";
</script>
