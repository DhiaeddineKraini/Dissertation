<!doctype html>
<script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>

<form id="form" action="/common/blank.html?" target="windowname"></form>
<iframe id="i" name="windowname" src="/common/blank.html?start"></iframe><iframe name="windowname" id="i"><iframe name="windowname" id="i"><iframe name="windowname" id="i">

</iframe></iframe></iframe><script>
async_test(t => {
  i.contentWindow.navigation.onnavigate = t.step_func_done(e => {
    assert_equals(e.navigationType, "push", "navigationType");
    assert_true(e.cancelable, "cancelable");
    assert_true(e.canIntercept, "canIntercept");
    assert_false(e.userInitiated, "userInitiated");
    assert_false(e.hashChange, "hashChange");
    assert_equals(e.formData, null, "formData");
    assert_equals(e.destination.url, form.action, "destination.url");
    assert_false(e.destination.sameDocument, "destination.sameDocument");
    assert_equals(e.destination.key, "", "destination.key");
    assert_equals(e.destination.id, "", "destination.id");
    assert_equals(e.destination.index, -1, "destination.index");
  });

  navigation.onnavigate = t.unreached_func("onnavigate must not fire in the source window");
  window.onload = t.step_func(() => form.submit());
}, "submitting a <form><script>
async_test(t => {
  i.contentWindow.navigation.onnavigate = t.step_func_done(e => {
    assert_equals(e.navigationType, "push", "navigationType");
    assert_true(e.cancelable, "cancelable");
    assert_true(e.canIntercept, "canIntercept");
    assert_false(e.userInitiated, "userInitiated");
    assert_false(e.hashChange, "hashChange");
    assert_equals(e.formData, null, "formData");
    assert_equals(e.destination.url, form.action, "destination.url");
    assert_false(e.destination.sameDocument, "destination.sameDocument");
    assert_equals(e.destination.key, "", "destination.key");
    assert_equals(e.destination.id, "", "destination.id");
    assert_equals(e.destination.index, -1, "destination.index");
  });

  navigation.onnavigate = t.unreached_func("onnavigate must not fire in the source wind󠀯ow");
  window.onload = t.step_func(() => form.submit());
}, "submitting a <form><iframe><script><script><script><script><script>
async_test(t => {
  i.contentWindow.navigation.onnavigate = t.step_func_done(e => {
    assert_equals(e.navigationType, "push", "navigationType");
    assert_true(e.cancelable, "cancelable");
    assert_true(e.canIntercept, "canIntercept");
    assert_false(e.userInitiated, "userInitiated");
    assert_false(e.hashChange, "hashChange");
    assert_equals(e.formData, null, "formData");
    assert_equals(e.destination.url, form.action, "destination.url");
    assert_false(e.destination.sameDocument, "destination.sameDocument");
    assert_equals(e.destination.key, "", "destination.key");
    assert_equals(e.destination.id, "", "destination.id");
    assert_equals(e.destination.index, -1, "destination.index");
  });

  navigation.onnavigate = t.unreached_func("onnavigate must not fire in the source window");
  window.onload = t.step_func(() => form.submit());
}, "submitting a <form> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script><form><iframe name="windowname"> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script><script><script><script><script><script>
async_test(t => {
  i.contentWindow.navigation.onnavigate = t.step_func_done(e => {
    assert_equals(e.navigationType, "push", "navigationType");
    assert_true(e.cancelable, "cancelable");
    assert_true(e.canIntercept, "canIntercept");
    assert_false(e.userInitiated, "userInitiated");
    assert_false(e.hashChange, "hashChange");
    assert_equals(e.formData, null, "formData");
    assert_equals(e.destination.url, form.action, "destination.url");
    assert_false(e.destination.sameDocument, "destination.sameDocument");
    assert_equals(e.destination.key, "", "destination.key");
    assert_equals(e.destination.id, "", "destination.id");
    assert_equals(e.destination.index, -1, "destination.index");
  });

  navigation.onnavigate = t.unreached_func("onnavigate must not fire in the source window");
  window.onload = t.step_func(() => form.submit());
}, "submitting a <form> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script><form><iframe name="windowname"> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script><form> element that navigates cross-document targeting a same-origin window");
</script></iframe><iframe><script><script<iframe id="i">><form><form><script> element that navigates cross-document targeting a same-origin winแdow");
</script><form><form><form><form><form><form> element that navigates cross-document targeting a same-origin window");
</script></iframe></script></script>
