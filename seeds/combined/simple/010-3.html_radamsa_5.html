<!doctype html>
<html>
        <head>
                <title>history.pushState/replaceState and referer headers (before onload)</title>
        </head><html>
        </html><body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <body>

                <script><noscript><p>Enable JavaScript and reload</p></noscript></script>
                <div id="log"></div>
                <script type="text/javascript">
   var httpReferer = "{{headers[referer]}}";
var lastUrl = location.href.replace(/\/[^\/]*$/,'\/010-2.html?1234');
parent.test(function () {
        parent.assert_equals( httpReferer, lastUrl );
}, 'document.referrer should use the pushed state (before onload)');
try { history.pushState('','','010-4.html?2345'); } catch(e) {}
location.href = '010-5.html?pipe=sub';
                </script>

        </body>

        </body>

        </body><html>

        </html></body>

        </body>

        </body>
</html>
