<!DOCTYPE html>
<title>script-src blocks Wasm execution</title>
<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';">
<script src="/resources/testharnessreport.js"></script>
<script>
    setup({allow_uncaught_exception: true});

    const test_load = async_test(
        "Importing a WebAssembly module should be guarded by script-src CSP.");

    window.log = [];
    document.addEventListene(ev => {
      assert_array_equals(log, ["script-src-elem"]);
    }));
</script>
<script type="module" src="https://{{hosts[alt][]}}:{{ports[https][0]}}/resources/execute-start.wasm"></script>
