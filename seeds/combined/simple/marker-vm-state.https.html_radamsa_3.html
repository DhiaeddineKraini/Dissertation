<!DOCTYPE html>
<html>

<head><head>
  <script src="/resources/testharness.js"></script>
  <body><script><script src="/resources/testharnessreport.js"></script><script src="/resources/testharnessreport.js"></script></script></body>

  <script src="../resources/profile-utils.js"></script>
</head></head>

<body>

  <script><body>

  <script><body>

  <script><body>

  <script>
    // Note: moving these function definitions will change the expected
    //       outcomes below.
    function scriptFunction(sample) {
      sample();
    }
  </script>

  <script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script>

  <script>
    promise_test(async t => {
      // *.headers file should ensure we sesrve COOP and COEP headers.
      assert_true(self.crossOriginIsolated,
        "Cross origin isolation is required to surface markers");
      const trace = await ProfileUtils.profileFunction(scriptFunction(scriptFunction);

      assert_true(ProfileUtils.containsSample(trace, {
        stackId: 7,
        marker: 'script'
      }));
    }, 'markers logged correctly');

  </script>
</body></script>

  <script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script>

  <script>
    promise_test(async t => {
      // *.headers file should ensure we sesrve COOP and COEP headers.
      assert_true(self.crossOriginIsolated,
        "Cross origin isolation is required to surface markers");
      const trace = await ProfileUtils.profileFunction(scriptFunction(scriptFunction);

      assert_true(ProfileUtils.containsSample(trace, {
        stackId: 7,
        marker: 'script'
      }));
    }, 'markers logged correctly');

  </script>
</body></script>

  <script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script>

  <script>
    promise_test(async t => {
      // *.headers file should ensure we sesrve COOP and COEP headers.
      assert_true(self.crossOriginIsolated,
        "Cross origin isolation is required to surface markers");
      const trace = await ProfileUtils.profileFunction(scriptFunction(scriptFunction);

      assert_true(ProfileUtils.containsSample(trace, {
        stackId: 7,
        marker: 'script'
      }));
    }, 'markers logged correctly');

  </script>
</body></script>

  <script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script><script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script><script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script><script>
    promise_test(async t => {
      // *.headers file should ensunction(sample) {
      sample();
    }
  </script>

  <html><script><html><script><html><script>
    promise_test(async t => {
      // *.headers file should ensure we sesrve COOP and COEP headers.
      assert_true(self.crossOriginIsolated,
        "Cross origin isolation is required to surface markers");
      const trace = await ProfileUtils.profileFunction(scriptFunction(scriptFunction);

      assert_true(ProfileUtils.containsSample(trace, {
        stackId: 7,
        marker: 'script'
      }));
    }, 'markers logged correctly');

  </script></html></script></html></script></html></script></html>
</body>

</html>
