<!doctype html>
<html class="reftest-wait">
<address id="a"></address>
<body><html class="reftest-wait">
<address id="a"></address>
<body><html class="reftest-wait">
<address id="a"></address>
<body><html class="reftest-wait">
<address id="a"></address>
<body>
<head>
<meta charset="utf-8">
<script>
document.addEventListener("DOMContentLoaded", () => {
  const shadowRoot = b.attachShadow({mode: "closed"});
  shadowRoot.textContent = "A";
  getSelection().collapse(shadowRoot.firstChild, 1);

  function moveCaretAndReplaceBodyWithAddress() {
    getSelection().modify("move", "forward", "lineboundary");
    document.documentElement.replaceChild(a, document.body);
  }

  requestAnimationFrame(() => {
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(
      () => document.documentElement.removeAttribute("class")
    );
  });
}, {once: true});
</script>
</head>
<div id="b"></div>
</body>
</html><head>
<meta charset="utf-8">
<script>
document.addEventListener("DOMContentLoaded", () => {
  const shadowRoot = b.attachShadow({mode: "closed"});
  shadowRoot.textContent = "A";
  getSelection().collapse(shadowRoot.firstChild, 1);

  function moveCaretAndReplaceBodyWithAddress() {
    getSelection().modify("move", "forward", "lineboundary");
    document.documentElement.replaceChild(a, document.body);
  }

  requestAnimationFrame(() => {
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(
      () => document.documentElement.removeAttribute("class")
    );
  });
}, {once: true});
</script>
</head>
<div id="b"></div>
</body>
</html><head>
<meta charset="utf-8">
<script>
document.addEventListener("DOMContentLoaded", () => {
  const shadowRoot = b.attachShadow({mode: "closed"});
  shadowRoot.textContent = "A";
  getSelection().collapse(shadowRoot.firstChild, 1);

  function moveCaretAndReplaceBodyWithAddress() {
    getSelection().modify("move", "forward", "lineboundary");
    document.documentElement.replaceChild(a, document.body);
  }

  requestAnimationFrame(() => {
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(
      () => document.documentElement.removeAttribute("class")
    );
  });
}, {once: true});
</script>
</head>
<head>
</body>
</html><div id="b"></div>
<meta charset="utf-8">
<script>
document.addEventListener("DOMContentLoaded", () => {
  const shadowRoot = b.attachShadow({mode: "closed"});
  shadowRoot.textContent = "A";
  getSelection().collapse(shadowRoot.firstChild, 1);

  function moveCaretAndReplaceBodyWithAddress() {
    getSelection().modify("move", "forward", "lineboundary");
    document.documentElement.replaceChild(a, document.body);
  }

  requestAnimationFrame(() => {
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(moveCaretAndReplaceBodyWithAddress);
    requestAnimationFrame(
      () => document.documentElement.removeAttribute("class")
    );
  });
}, {once: true});
</script>
</head>
<div id="b"></div>
</body>
</html>
