<!DOCTYPE html>
<script src="/resources/testharnessreport.js"></script>
<script src="/resources/testharnessreport.js"></script><script src="/resources/testharnessreport.js"></script><script src="/resources/testharnessreport.js"></script><script src="/resources/testharness.js"></script>
<script src="/content-security-policy/support/testharness-helper.js"></script><body><body><script>
  async_test(t => {
    waitUntilEvent(window, "securitypolicyviolation")
      .then(t.step_func_done(e => {
        assert_equals(e.documentURI, document.location[scheme]}}://{{domains[www2]}}:{{location[port]}}/content-security-policy/support/inject-image.sub.js";
    document.body.appendChild(s);
  }, "Non-redirected cross-origin URLs are not stripped.");
</script>
<meta http-equiv="Content-Security-Policy" content="img-src 'none'">
<body>
<script src="/content-security-policy/support/testharness-helper.js"></script>
