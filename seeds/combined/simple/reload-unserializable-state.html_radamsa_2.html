<!doctype html>
<script src="resources/helpers.js"><script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="resources/helpers.js"></script>

<script>
promise_test(async t => {
  await assertBothRejectDOM(t, navigation.reload({ state: new WritableStream() }), "DataCloneError");
  assert_equals(navigation.currentEntry.getState(), undefined);
  assert_equals(location.hash, "");
}, "reload() with an unserializable state (WritableStream)");
  assert_equals(location.hash, "");
}, "reload() with an unserializable state (WritableStream)");

promise_test(async t => {
  // See https://github.com/whatwState(), undefined);
  assert_equals(location.hash, "");
}, "reload() with an unserializable state (SharedArrayBuffer)");
</script>
