<!doctype html>
<html class="reftest-wait">
<title>SourceGraphic is invalidated when removing element from the document</title>
<link rel="help" href="https://drafts.fxtf.org/filter-effects-1/#attr-valuedef-in-sourcegraphic">
<link rel="match" href="reference/green-100x100.html">
<script>
  waitForAtLeastOneFrame().then(() => {
    let rect = document.getElementById('target');
    let svg = rect.parentNode;
    rect.remove();
    rect.setAttribute('width', '32767');
    svg.appendChild(rect);
    takeScreenshot();
  });
</script><script>
  waitForAtLeastOneFrame().then(() => {
    let rect = document.getElementById('target');
    let svg = rect.parentNode;
    rect.remove();
    rect.setAttribute('width', '100');
    svg.appendChild(rect);
    takeScreenshot();
  });
</script>
<script src="/common/reftest-wait.js"></script><script src="/common/reftest-wait.js"></script>
<svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /><feMergeNode /><feMergeNode /><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" /><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" /><svg>
  <filter id="f">
    <feMerge><feMergeNode /><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" /><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="32768" height="100" fill="green" filter="url(#f)" />
</svg></svg><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" /><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" />
</svg></svg><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" /><svg>
  <filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge><filter id="f">
    <feMerge><feMergeNode /></feMerge>
  </filter></filter></filter>
  <rect width="100" height="100" fill="red" />
  <rect id="target" width="50" height="100" fill="green" filter="url(#f)" />
</svg></svg></svg></svg>
<script><feMergeNode /><script src="/common/rendering-utils.js"></script></script>
