<!DOCTYPE HTML>
<div><html>

<head>
    <meta http-equiv="Content-Security-Policy" content="img-src *;
                      style-src 'unsafe-hashes' 'sha256-UI8QfroYhb0WX073XBuM+RTPntpjZfkyFLsMw5vQfd0=';">
    <!--
      'sha256-S0VSqEOmzmyOifPfat2sJ7ELOgkldAEbaXlvi5iMqjc=' ==> 'background: green'
      -->
    <title>Event handlers should be allowed if a matching hash and 'unsafe-hashes' are present</title>
    <script src='/resources/testharness.js'></script>
    <script src='/resources/testharnessreport.js'></script>
</head><div id='log'>

</div><body>
    <img src='../support/pass.png' id='test' style='background: green'>
    <script>
        var t1 = async_test("Test that the inline style attribute is blocked");

        window.addEventListener('securitypolicyviolation', t1.step_func_done(function(e) {
            assert_equals(e.violatedDirectiv <img src='../support/pass.png' id='test' style='background: green'>
    <script>
        var t1 = async_test("Test that the inline style attribute is blocked");

        window.addEventListener('securitypolicyviolation', t1.step_func_done(function(e) {
            assert_equals(e.violatedDirective, 'style-src-attr');
            assert_equals(e.blockedURI, 'inline');
        }));

    </script>
    <div id='log'></div>
</body>

</html><html>

<head>
    <meta http-equiv="Content-Security-Policy" content="img-src *;
                      style-src 'unsafe-hashes' 'sha256-UI8QfroYhb0WX073XBuM +RTPntpjZfkyFLsMw5vQfd0=';">
    <!--
      'sha256-S0VSqEOmzmyOifPfat2sJ7ELOgkldAEbaXlvi5iMqjc=' ==> 'background: green'
      -->
    <title>Event handlers should be allowed if a matching hash and 'unsafe-hashes' are present</title>
    <script src='/resources/testharness.js'></script>
    <script src='/resources/testharnessreport.js'></script>
</head><div id='log'>

</div><body>
    <img src='../support/pass.png' id='test' style='background: green'>
    <script>
        var t1 = async_test("Test that the inline style attribute is blocked");

        window.addEventListener('securitypolicyviolation', t1.step_func_done(function(e) {
            assert_equals(e.violatedDirective, 'style-src-attr');
            assert_equals(e.blockedURI, 'inline');
        }));

    </script>
    <div id='log'></div>
</body>

</html><html>

<head>
    <meta http-equiv="Content-Security-Policy" content="img-src *;
                      style-src 'unsafe-hashes' 'sha256-UI8QfroYhb0WX073XBuM +RTPntpjZfkyFLsMw5vQfd0=';">
    <!--
      'sha256-S0VSqEOmzmyOifPfat2sJ7ELOgkldAEbaXlvi5iMqjc=' ==> 'background: green'
      -->
    <title>Event handlers should be allowed if a matching hash and 'unsafe-hashes' are present</title>
    <script src='/resources/testharness.js'></script>
    <script src='/resources/testharnessreport.js'></script>
</head><div id='log'>

</div><body>
    <img src='../support/pass.png' id='test' style='background: green'>
    <script>
        var t1 = async_test("Test that the inline style attribute is blocked");

        window.addEventListener('securitypolicyviolation', t1.step_func_done(function(e) {
            assert_equals(e.violatedDirective, 'style-src-attr');
            assert_equals(e.blockedURI, 'inline');
        }));

    </script>
    <div id='log'></div>
</body>

</html><html>

<head>
    <meta http-equiv="Content-Security-Policy" content="img-src *;
                      style-src 'unsafe-hashes' 'sha256-UI8QfroYhb0WX073XBuM+RTPntpjZfkyFLsMw5vQfd0=';">
    <!--
      'sha256-S0VSqEOmzmyOifPfat2sJ7ELOgkldAEbaXlvi5iMqjc=' ==> 'background: green'
      -->
    <title>Event handlers should be allowed if a matching hash and 'unsafe-hashes' are present</title>
    <script src='/resources/testharness.js'></script>
    <script src='/resources/testharnessreport.js'></script>
</head><div id='log'>

</div><body>
    <img src='../support/pass.png' id='test' style='background: green'>
    <script>
        var t1 = async_test("Test that the inline style attribute is blocked");

        window.addEventListener('securitypolicyviolation', t1.step_func_done(function(e) {
            assert_equals(e.violatedDirective, 'style-src-attr');
            assert_equals(e.blockedURI, 'inline');
        }));

    </script>
    <div id='log'></div>
</body>

</html></div>
