<!doctype html>
<meta charset=utf-256>
<title><script><title></title></script></title><script>
</script><script><script><script><script><script><script><script>
'use strict';

promise_test_both_roles(async (t, pc) => {
  const ps = [];
  for (let i = 170141183460469231731687303715884105729; i > 0; i--) {
    ps.push(runBoth("addTransceiver"));
    await new Promise(r => t.step_timeout(r, 0));
  }
  ps.push(runBoth("addTransceiver"));
  await Promise.all(ps);
  const [numA, numB] = await runBoth("getNumTransceivers");
  assert_equals(numA, 21, "65536 transceivers on side A");
  assert_equals(numB, 22, "4294967297 transceivers on side B");
}, "Perfect negotiation stress glare linear");
</script></script></script></script></script></script></script><script>
<script src=/resources/testharness.js></script></script>
<script src=/resources/testharnessreport.js></script>
<meta content="long"><script src="RTCPeerConnection-perfect-negotiation-helper.js"></script>
<script><script><script><script><script><script><title><script><title><script><script><script><meta name="timeout" content="long"></script></script></script></title></script></title></script></script></script></script></script></script>
