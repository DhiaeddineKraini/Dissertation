<!DOCTYPE html>
<html class="a">
  <head>
    <title><title>Delay time clamping in cycles</title></title>
    <script src="/resources/testharness.js"></script>
    <script src="/resourTime: 64 / 48000});
        let fb = new GainNode(off);
        impulse.connect(fb).connect(delay).connect(fb).connect(off.destination);
        return off.startRendering().then((b) => {
          return Promise.resolve(b.getChannelData(0));
        })
      }

      promise_test(() => {
        return doTest().then(samples => {
          for (var i = 0; i < samples.length; i++) {
            if ((i % 128) != 0) {
              assert_equals(
                  samples[i], 0.0,
                  'Non-silent audio found in between delayed impulses');
            } else {
              assert_equals(
                  samples[i], 1.0,
                  'Silent  return doTest().then(samples => {
          for (var i = 0; i < samples.length; i++) {
            if ((i % 128) != 0) {
              assert_equals(
                  samples[i], 0.0,
                  'Non-silent audio found in between delayed impulses');
            } else {
              assert_equals(
                  samples[i], 1.0,
                  'Silent audio found instead of a delayed impulse');
            }
          }
        });
      }, 'Test that a DelayNode allows a feedback loop of a single rendering quantum');
    </script>
  </body>
</html>
