<!DOCTYPE html>
<meta name="timeout" content="long"><meta name="timeout" content="long"><meta name="timeout" content="long">
<script src="/resources/testharness.js"></script><meta><script src="/resources/testharness.js"></script>
<scetup(() => assertSpeculationRulesIsSupported());

// moveTo and moveBy operations should be ignored.
// See https://github.com/jeremyroman/alternate-loading-modes/issues/73.
['moveTo', 'moveBy'].forEach(moveFunc => {
  promise_test(async t => {
    const uid = token();
    const bc = new PrerenderChannel('test-channel', uid);
    t.add_cleanup(_ => bc.close());

    const gotMessage = new Promise(resolve(e.data);
      }, {once: true});
    });

    const url = `resources/windowidth=${window.screen.availWidth / 2},
                 height=${window.screen.availHeight / 2},
                 noopener`);

    const result = await gotMessage;
    assert_equals(result.status, 'PASS');
    assert_equals(
        result.prevPosition.y, result.newPosition.y,
        'y position for prerendering');
  }, `a prerendering page cannot move its window by executing ${moveFunc}.`);
});
</script>
