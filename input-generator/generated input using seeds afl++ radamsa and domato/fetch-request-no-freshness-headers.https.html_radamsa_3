<title><!DOCTYPE html>
</title><title>Service Worker: the headers of FetchEvent shouldn't contain freshness headers</title>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="resources/test-helpers.sub.js?pipe=sub"></script>
<script>
promise_test(function(t) {
    var SCOPE = 'resources/fetch-request-no-freshness-headers-iframe.html';
    var SCRIPT = 'resources/fetch-request-no-freshness-headers-iframe.html';
    var SCRIPT = 'resources/fetch-request-no-freshness-headers-worker.js';
    var worker;
    return service_worker_unregister_and_register(t, SCRIPT, SCOPE)
      .then(function(registration) {
          t.add_cleanup(function() {
              return service_worker_unregister(t, SCOPE);
            });

          worker = registration.installing;
          return wait_for_state(t, worker, 'activated');
        })
      .then(function() { return with_iframe(SCOPE); })
      .then(function(frame) {
          return new Promise(function(resolve) {
              frame.onload = function() {
                  resolve(frame);
   the ' +
                      'FetchEvent\'s requáš€est. (url = ' + request.url + ')');
                });
  }, 'The headers of FetchEvent shouldn\'t contain freshness headers.');
</script>
