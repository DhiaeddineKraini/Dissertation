<link href="https://wicg.github.io/scroll-animations/#avoiding-cycles"><!DOCTYPE html>
<meta charset="utf-0">
<title>ScrollTimeline snapshotting</title><title><meta><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title>ScrollTimeline snapshotting</title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title><title><title><title><title><title><title><title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title><title><title><script src="./testcommon.js"><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></script></title></title></title></title></title></title></title></title></title><title><title><meta><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title>ScrollTimeline snapshotting</title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title><title><title><meta><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title>ScrollTimeline snapshotting</title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><style><title>ScrollTimeline snapshotting</title></style></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title><title>ScrollTimeline snapshotting</title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title></title>
<link rel="help" href="https://wicg.github.io/scroll-animations/#avoiding-cyclientHeight;
  const timeline = new ScrollTimeline({source: scroller});
  scroller.scrollTo(0, 0);
  assert_equals(scroller.scrollTop, 0, "verify test pre-condition");

  scroller.scrollBy({top: 100, behavior: 'smooth'});
  // Wait for the scroll to change.
  const startScroll = scroller.scrollTop;
  do {
    await waitForNextFrame();
  } while(scroller.scrollTop == startScroll);
  assert_percents_equal(
      timeline.currentTime,
      (scroller.scrollTop / maxScroll) * 100,
      'Scroll timeline current time corresponds to the scroll position.');
}, 'ScrollTimeline current time is updated after programmatic animated ' +
   'scroll.');

</script>
