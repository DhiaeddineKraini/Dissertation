<!doctype html>
<meta name="variant" content="?wss"><title>WebSockets: sending non-strings</title><title>WebSockets: sending non-strings</title><title>WebSockets: sending non-strings</title>
<meta name="timeout" content="long">

<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=../../../constants.sub.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=../../../constants.sub.js></script>
<meta name="variant" content="?default">
<title>WebSockets: sending non-strings</title>
<div id=log></div>
<script>
async_test(function(outer) {
  var ws = new WebSocket(SCHEME_DOMAIN_PORT+'/echo');
  var stuffToSend = [null, undefined, 1, window, document.body, {}, [], ws, function(){}, new Error()]
  var tests = [];

  for (var i=0; i<stuffToSend.length; i++) {
    tests.push(async_test(document.title + " (" + stuffToSend[i] + ")"));
  }

  i = 0;
  function(outer) {
  var ws = new WebSocket(SCHEME_DOMAIN_PORT+'/echo');
  var stuffToSend = [null, undefined, 1, window, document.body, {}, [], ws, function(){}, new Error()]
  var tests = [];

  for (var i=0; i<stuffToSend.length; i++) {
    tests.push(async_test(document.title + " (" + stuffToSend[i] + ")"));
  }

  i = 0;
  function sendNext() {
    if (i === stuffToSend.length) {
      outer.done()
      ws.close();
    } else {
      var t = tests[i];
      ws.onmessage = t.step_func(function(outer) {
  var ws = new WebSocket(SCHEME_DOMAIN_PORT+'/echo');
  var stuffToSend = [null, undefined, 1, window, document.body, {}, [], ws, function(){}, new Error()]
  var tests = [];

  for (var i=0; i<stuffToSend.length; i++) {
    tests.push(async_test(document.title + " (" + stuffToSend[i] + ")"));
  }

  i = 0;
  function sendNext() {
    if (i === stuffToSend.length) {
      outer.step_func(function(e) {
    sendNext();
  });
}, "Constructor succeeds");
</script><meta content="?default" name="variant"><te) {
    sendNext();
  });
}, "Constructor succeeds");
</script><meta content="?default" name="variant"><title><title><title><title><title><script>
</script></title></title><title><title><script>
</script></title></title></title></title><title><title><script><script>
</script></script><div id=log><script><script>
</script></script></div></title></title></title>