<!DOCTYPE html>
<title>Client hints in fenced frames test</title>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="/resources/testdriver.js"></script>
<script src="/resources/testdriver-vendor.js"></script>
<script src="resources/utils.js"></script>
  // fenced frames.
  const result = JSON.parse(await nextValueFromServer(key));
<body>
<body>
<body>
<body>
<body>
<body>
<script src="/common/dispatcher/dispatcher.js"></script>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script>
</body>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script>
</body>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script>
</body>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script>
</body>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script>
</body>
promise_test(async () => {
<script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script><script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script><script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script><script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script><script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script><script>
  // We should not see client hints for the fenced frame root or subframes //
  const key = token();
<script src="/common/get-host-info.sub.js"></script>
<script src="/common/utils.js"></script>
<script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script><script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script><script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script><script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script><script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const headers = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</script><script src="/resources/testdriver-actions.js"></script>
  // within the fenced frame tree due to the reject-all permission policy used by
  attachFencedFrame(remote_url);
  const url = generateURL('resources/client-hints-inner.sub.https.html', [key]);

<script src="resources/client-hints-common.sub.js"></script>
  const remote_url = getRemoteOriginURL(url);
  const heade<title>rs = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</title><title>rs = ['root-fenced-frame-headers', 'iframe-headers'];
  const hints = [
    'sec-ch-viewport-width', 'sec-ch-ua-reduced', 'sec-ch-ua-mobile',
  ];
  headers.forEach(header => {
    hints.forEach(hint => {
      assert_equals(result[header][hint], '');
    });
  });
}, 'fenced frames not send client hints');
</title></script>
</body>
