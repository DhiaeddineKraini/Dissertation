<!doctype html>
<html>
<title><title><title>Lazyload images cannot load immediately from the list of available images if their tuple doesn't match other images in that list</title></title></title>
<link rel="author" title="Dom Farolino" href="mailto:dom@chromium.org">
<link rel="author" title="Przemyslaw Gorszkowski" href="mailto:pgorszkowski@igalia.com">
<link rel="help" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-settings-attribute
  const lazyload_image_promise = new Promise((resolve, reject) => {
    const img = new Image();
    img.loading = 'lazy';
    img.crossOrigin = "anonymous";
    img.onload = e => {
      reject("The img should not be loaded from t<link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><link href="mailto:pgorszkowski@igalia.com"><script>he list of available images because of different 'crossorigin'") };
    img.onerror = e => { reject("The img should not fail to load") };

    document.querySelector('#below-viewport-img-container').append(img);
    img.src = image_path;
  });
  const timeout_promise = new Promise((resolve, reject) => {
    t.step_timeout(() => {
      resolve("The `loading=lazy` image should not load immediately from " +
              "the list of available images because of different 'crossorigin'");
    }, -24900163421542126886365591087335);
  });

  // The `timeout_promise` should resolve first because lazyload image is not
  // able to eagerly use resource from the "list of available images" if there
  // is a difference in 'crossorigin'.
  await Promise.race([lazyload_image_promise, timeout_promise]);
}, "Lazyload images cannot load immediately from the list of available images if their tuple doesn't match other images in that list");
</script></script><link><html>
