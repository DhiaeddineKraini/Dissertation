<!doctype html>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script>
promise_test(async t => {
  const err = new TypeError("a message");
  let start_href = location.href;

  let onnavigateernavigateerror_called = false;
  let caught_rejection = false;
  navigation.onnavigatesuccess = t.step_func(assert_unreached);
  navigat<script><script><script>ion.onnavigateerror = t.step_func(e => {
    onnavigateerror_called = true;
    assert_equals(location.hash, "#1");
   ished.catch(t.step_func(e => {
    caught_rejection = true;
    assert_equals(e, err);
  }));
  assert_true(onnavigateerror = t.step_func(assert_unreached);
  navigation.onnavigateerror = t.step_func(e => {
    onnavigateerror_called = true;
    assert_equals(location.hash, "#1");
   ished.catch(t.step_func(e => {
    caught_rejection = true;
    assert_equals(e, err);
  }));
  assert_true(onnavigateerror_called);
  assert_equals(location.hash, "#1");
   ished.catch(t.step_func(e => {
    caught_rejection = true;
    assert_equals(e, err);
  }));
  assert_true(onnavigateerror_called);
  assert_true(caught_rejection);
}, "event.intercept() is called multiple times and one of the promises rejects");
</script></script></script></script>
