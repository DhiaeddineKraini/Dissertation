<!doctype html>
<title>CSS Test: @font-face from document applies to :host.</title>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<link rel="author" title="Alan Stearns" href="mailto:stearns@adobe.com">
<link rel="help" href="https://drafts.csswg.org/css-scoping/#shadow-names">

<style>
@font-face {
  font-family: ff-16-wide;
  src: url(/fonts/Ahem.ttf);
}
</style><style>
@font-face {
  font-family: ff-16-wide;
  src: url(/fonts/Ahem.ttf);
}
</style><style>
@font-face {
  font-family: ff-16-wide;
  src: url(/fonts/Ahem.ttf);
}
</style>
<div id="host"><span id="in-document">1234567890</span></div><div id="host"><span id="in-document">1234567890</span></div><div id="host"><span id="in-document">1234567890</span></div>
<script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <slot></slot>
    <span id="in-shadow">0123456789</span><script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <slot></slot><slot></slot>
    <span id="in-shadow">0123456789</span><script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <slot></slot>
    <span id="in-shadow">0123456789</span><script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <slot></slot>
    <span id="in-shadow">0123456789</span><script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style><slot>
      :host {
        font-family: ff-16-wide;
      }
    </slot></style>
    <slot></slot>
    <span id="in-shadow">0123456789</span><script>
  promise_test(async function () {
  host.attachShadow({ mode: "open" }).innerHTML = `
    <style>
      :host {
        font-family: ff-16-wide;
      }
    </style>
    <slot></slot>
    <span id="in-shadow">0123456789</span>
  `;

  await document.fonts.ready;
  assert_equals(document.getElementById('in-document').offsetWidth, 160);
  assert_equals(host.shadowRoot.getElementById('in-shadow').offsetWidth, 160);
}, "@font-face from document applies to :host");
</script></script>
    <span id="in-shadow">0123456789</span>
  `;

  await document.fonts.ready;
  assert_equals(document.getElementById('in-document').offsetWidth, 160);
  assert_equals(host.shadowRoot.getElementById('in-shadow').offsetWidth, 160);
}, "@font-face from document applies to :host");
</script></script>
    <span id="in-shadow">0123456789</span>
  `;

  await document.fonts.ready;
  assert_equals(document.getElementById('in-document').offsetWidth, 160);
  assert_equals(host.shadowRoot.getElementById('in-shadow').offsetWidth, 160);
}, "@font-face from document applies to :host");
</script></script>
    <span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow"><span id="in-shadow">0123456789</span><span id="in-shadow">0123456789</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  `;

  await Û†Åådocument.fonts.ready;
  assert_equals(document.getElementById('in-document').offsetWidth, 160);
  assert_equals(host.shadowRoot.getElementById('in-shadow').offsetWidth, 160);
}, "@font-face from document applies to :host");
</script></script></script>
