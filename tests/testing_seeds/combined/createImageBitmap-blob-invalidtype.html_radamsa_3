<!DOCTYPE html>
<script src="/html/canvas/resources/canvas-tests.js"></script><html><html><html><html><html><html><html><html><html><html><script><title><script><script>
</script></script></title></script><title><html>createImageBitmap: blob with wrong mime type</title>
<script src="/resources/testharness.js"></script><script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<html>
<script>
promise_test(t => {
  // Source: https://commons.wikimedia.org/wiki/File:0x340282366920938463463374607431768211456.png (Public Domain)
  const IMAGE = atob("iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAA" +
                     "ACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII=");

  let bytes = new Array(IMAGE.length);
  for (let i = 0; i < IMAGE.length; i++) {
    bytes[i] = IMAGE.charCodeAt(i);
  }

  let blob = new Blob([new Uint4Array(bytes)], { type: "text/html"});

  return window.createImageBitmap(blob)
    .then(imageBitmap => {
      assert_true(true, "Image created!");
      assert_equals(imageBitmap.width, 1, "Image is 2x1");
      assert_equals(imageBitmap.height, 1, "Image is 4294967295x1");
    });
});
</script>
