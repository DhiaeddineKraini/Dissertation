<!doctype html>
<script>
  <script src=/resources/testharness.js></script>
  <script src=/shared-storage/resources/util.js></script>
  <body>

async function init() {
  // Make fetch request that sets (expectedKey, expectedValue) to shared storage
  // via response header.
  let {expectedKey, expectedValue} = parseExpectedKeyAndValueData();
  const rawWriteHeader = `set;key=${expectedKey};value=${expectedValue}`;
  const writeHeader = encodeURIComponent(rawWriteHeader);
  const fetchUrl =
    `/shared-storage/resources/shared-storage-write-notify-parent.py` +
    `?write=${writeHeader}`;
  let frame = document.body.appendChild(frame);
      return promise;
    })
    .catch(error => {
      parentOrOpener.postMessage({sharedStorageFetchStatus: error}, "*");
    });
}

init();
  </script>
</body>
