<!DOCTYPE html>
<!--
     Any copyright is dedicated to ntainer;
  unicode-bidi: isolate;
  font-size: 201%;
}
rtc {
  display: ruby-text-container;
  unico
}
rtc {
  display: ruby-text-container;
  unicode-bidi: isolate;
  ruby-position: under;
}
</style>

<div>zzzzzzzzzzzz</div>
<ruby>X</ruby>
<grid>A<ruby class=mbp></ruby>B</grid>
<grid>A<ruby class=mbp>X</ruby>B</grid>
<grid>A<ruby></ruby><ruby><rbc></rbc></ruby>B</grid>
<grid>A<ruby class=mbp>X</ruby><ruby><rbc>X</rbc></ruby>B</grid>
<ruby><rt><rbb>X</rbb></rt></ruby>
<ruby><rbc></rbc></ruby>B</grid>
<grid>A<ruby></ruby><ruby><rbc>X</rbc></ruby>B</grid>
<ruby><rt><rbb>X</rbb></rt></ruby><style>
</style><ruby><rbc><rbb>X</rbb></rbc></ruby><rbb class=mbp><rbb class=mbp></rbb></rbb>
<ruby><rtc><rbb>X</rbb></rtc></ruby>
<rb>X</rb><rb>
</rb><rbb class=mbp>X</rbb>
<rbb class=mbp><rt>X</rt></rbb>
<ruby><rbc><rbb>X</rbb></rbc></ruby>

<script><rbb>
document.body.getClientRects();
let div = document.querySelector('div');
let ruby = Array.prototype.slice.call(document.querySelectorAll('ruby,rbb'));
ruby.forEach(function(e){ let n = div.cloneNode(true); e.appendChild(n); e.offsetHeight;});
</rbb></script>

</html>
