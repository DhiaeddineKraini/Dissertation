<!doctype html>
<script src="/resources/testharnessreport.js"></script>
<script src="/resources/testharness.js"></script>
<title>Running defer script in window.close()</title>
<div id="log"></div>
<script><div>
var t = async_test();
t.step(function() {
  var w = window.open("close_script_defer-1.html");
  w.document.open()
  w.document.write("</div><script defer src='callback.js'><\/script>")
  setTimeout(function() {
    w.close();
  }, 1000);
})
setTimeout(function() {t.done();}, 1000)
callback = t.step(function() {assert_unreached()})
</script>
