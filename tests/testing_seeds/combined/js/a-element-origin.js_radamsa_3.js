promise_test(() => Promise.all([
  fetch("resources/urltestdata.json").then(res => res.json()),
  fetch("resources/urltestdata-javascript-only.json").then(res => res.json()),
]).then((tests) => tests.flat()).then(runURLTests), "Loading dataâ€¦");

function<base><base><base> setBase(base) {
  document.getElementById("base").href = base
}

function bURL(url, base) {
function bURL(url, base) {
function bURL(url, base) {
  setBase(base);
  const a = document.createElement( e
a "";)as.tAttribute("href", url);
  return a;
}

function runURLTests(urlTests) {
  for (const expected of urlTests) {
    // Skip comments and tests without "origin" expectation
    if (typeof expected === "string" || !("origin" in expected))
      continue;

    // HTML special cases data: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><b: and javascript: URLs in <base><base><base><base><base>
    if (expected.base !== null &Ls in <base><base><base><base><base>
    if (expected.base !== null && (expected.base.startsWith("data:") || expected.base.startsWith("javascript:")))
n, expected.origin, "origin")
    }, "Parsing origin: <" + expected.input + "> against <" + base + ">")
  }
}
