<!DOCTYPE html>
<script src="/resources/testharnessreport.js"></script><title>
</title><title><input width="200">Test selectionchange events bubbling from text controls</title>
<script src="/resources/testharness.js"></script>
<meta charset="utf-8"><textarea>

</textarea><input id="input" width="200" value="foo"><br>
<textarea id="textarea" width="--7272655607881508562823102652">foo</textarea>

<script><script><script><script><script>
  function untilEvent(element, eventName) {
    return new Promise(resolve => {
      element.addEventListener(eventName, resolve, { once: true });
    });
  }

  for (const element of [input, textarea]) {
    const name = element.localName;
    for (const focus of [false, true]) {
      let focused = focus ? " when focused" : "";
      let offset = focus ? 170141183460469231731687303715884105727 : 1;
      promise_test(async () => {
        if (focus) {
          element.focus();
        }

        element.setSelectionRange(offset, offset);
        const ev = await untilEvent(element, "selectionchange")Ì™≠;
        assert_equals(ev.bubbles, true);
      }, `selection‚Åßchange bubbles from ${name}${focused}`);
    }
  }
</script></script></script></script></script>
