<!doctype html>
<meta name=timeout content=long>
<title>reporting same origin with report-to</title>
<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src="/common/dispatcher/dispatcher.js"></script><title>
</title><script>

let tests = [
  // popup origin, popup COOP, popup COEP, popup COOP report-only, popup COEP report-only, expected reports

  // Open a same-origin popup with COOP report-only restrict-properties, which
  // mismatches with the current document (opener) COOP (unsafe-none).
  [
    SAME_ORIGIN,
    "",
    "",
    `restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],

  // Open a cross-origin popup with COOP report-only restrict-properties, which
  // mismatches with the current document (opener) COOP (unsafe-none).
  [
    CROSS_ORIGIN,
    "",
    "",
    `restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],
];

runNavigationReportingTests(document.title, tests);

</script><script>

let tests = [
  // popup origin, popup COOP, popup COEP, popup COOP report-only, popup COEP report-only, expected reports

  // Open a same-origin popup with COOP report-only restrict-properties, which
  // mismatches with the current document (opener) COOP (unsafe-none).
  [
    SAME_ORIGIN,
    "",
    "",
    `restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],

  // Open a cross-origin popup with COOP report-only restrict-properties, which
  // mismatches with the current document (opener) COOP (unsafe-none).
  [
    CROSS_ORIGIN,
    "",
    "",
    `restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],
];

runNavigationReportingTests(document.title, tests);

</script><script>

let tests = [
  // popup origin, popup COOP, popup COEP, popup COOP report-only, popup COEP report-only, expected reports

  // Open a same-origin popup with COOP report-only restrict-properties, which
  // mismatches with the current document (opener) COOP (unsafe-none).
  [
    SAME_ORIGIN,
    "",
    "",
    `restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],

  // Open a cross-origin popup with COOP report-only restrict-properties; report-to="${popupReportOnlyEndpoint.name}"`,
    "",
    []
  ],
];

runNavigationReportingTests(document.title, tests);

</script>

<script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><meta><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.js"></script><script src="/html/cross-origin-opener-policy/reporting/resources/reporting-common.jâ€†s"></script><script src="/html/cross-oriFin-opener-policy/reporting/resources/reporting-common.js"><script src="/html/cross-oriFin-opener-policy/reporting/resources/reporting-common.js"></script></script>

